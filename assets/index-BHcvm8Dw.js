(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const E of a.addedNodes)E.tagName==="LINK"&&E.rel==="modulepreload"&&s(E)}).observe(document,{childList:!0,subtree:!0});function n(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=n(l);fetch(l.href,a)}})();const r=document.getElementById("gameCanvas"),t=r.getContext("2d"),ee=.5,J=4,d=400,w=3200;let g=0;const I=[],G=[],L=[];let f={x:0,y:0,height:80};const o={x:100,y:d-50,width:40,height:50,vx:0,vy:0,onGround:!1},y=[],k=[];function U(){let e=0;const i=[];for(;e<w;){const c=Math.random()<.2?320:160+Math.random()*160;let b;if(Math.random()<.25){const Z=(Math.random()<.5?1:-1)*(20+Math.random()*20);b={x:e,y:d,width:c,height:50,endY:d+Z,isSlope:!0}}else b={x:e,y:d,width:c,height:50};y.push(b),i.push({x:e+c/2,y:d-30}),Math.random()<.5&&I.push({x:e+c/2-10,y:d-30,width:20,height:20,collected:!1,type:"coin"}),Math.random()<.3&&e>0&&G.push({x:e-40,y:d+35,width:40,height:15}),Math.random()<.2&&e>0&&L.push({x:e-60,y:d-100,width:80,height:20,dx:2,range:120,startX:e-60}),e+=c;const Q=60+Math.random()*80;e+=Q,Math.random()<.5&&e<w-50&&k.push({x:e+10,y:d-40,width:40,height:40})}if(i.length>0){const c=Math.floor(Math.random()*i.length),b=i[c];I.push({x:b.x-10,y:b.y,width:20,height:20,collected:!1,type:"heart"})}const n=100;y.some(c=>c.x<=n&&c.x+c.width>=n+40)||y.unshift({x:60,y:d,width:80,height:50});const l=y[y.length-1];let a=l.x+l.width-32,E="isSlope"in l&&l.isSlope?l.endY-f.height:l.y-f.height;f.x=a,f.y=E}U();function Y(e,i){return e.x<i.x+i.width&&e.x+e.width>i.x&&e.y<i.y+i.height&&e.y+e.height>i.y}let S=0,_=1,te=w-100,P=0,T=3,X=!1,C=Number(localStorage.getItem("topScore")||"0"),A=!1,R=0;function q(e){e>C&&(C=e,localStorage.setItem("topScore",String(C)))}function oe(){S=0,_=1,T=3,X=!1,y.length=0,k.length=0,I.length=0,G.length=0,L.length=0,U(),K()}function K(){o.x=100,o.y=d-50,o.vx=0,o.vy=0}function j(){if(T--,T<=0){q(S),X=!0,F();return}K(),P=30}function F(){let e=document.getElementById("restart-btn");e?e&&(e.style.display="block",e.style.top="calc(50% + 120px)",e.style.transform="translateX(-50%)"):(e=document.createElement("button"),e.id="restart-btn",e.textContent="Restart",e.style.position="fixed",e.style.left="50%",e.style.top="calc(50% + 120px)",e.style.transform="translateX(-50%)",e.style.fontSize="2em",e.style.padding="16px 32px",e.style.zIndex="100",e.style.background="#222",e.style.color="#fff",e.style.border="2px solid #0cf",e.style.borderRadius="12px",e.style.cursor="pointer",e.onclick=()=>{e?.remove(),oe()},document.body.appendChild(e))}function le(){const e=document.getElementById("restart-btn");e&&(e.style.display="none")}function ie(){y.length=0,k.length=0,I.length=0,G.length=0,L.length=0,U(),K(),_++,W(),A=!1,R=0}function ne(){W(),A=!0,R=120}function re(){if(!X){if(A){R--,R<=0&&ie();return}if(P>0){P--;return}o.vx=0,(h.ArrowLeft||h.KeyA)&&(o.vx=-J),(h.ArrowRight||h.KeyD)&&(o.vx=J),(h.ArrowUp||h.Space||h.KeyW)&&o.onGround&&(o.vy=-12,o.onGround=!1),o.vy+=ee,o.x+=o.vx,o.y+=o.vy,o.onGround=!1;for(const e of y)if("isSlope"in e&&e.isSlope){if(o.x+o.width>e.x&&o.x<e.x+e.width){const i=(o.x+o.width/2-e.x)/e.width,n=e.y+(e.endY-e.y)*i;o.y+o.height>n&&o.y+o.height<n+e.height&&o.vy>=0&&(o.y=n-o.height,o.vy=0,o.onGround=!0)}}else o.y+o.height>e.y&&o.y+o.height<e.y+e.height&&o.x+o.width>e.x&&o.x<e.x+e.width&&o.vy>=0&&(o.y=e.y-o.height,o.vy=0,o.onGround=!0);for(const e of k)Y(o,e)&&(o.y+o.height-o.vy<=e.y?(o.y=e.y-o.height,o.vy=0,o.onGround=!0):o.x+o.width-o.vx<=e.x?o.x=e.x-o.width:o.x-o.vx>=e.x+e.width?o.x=e.x+e.width:o.y-o.vy>=e.y+e.height&&(o.y=e.y+e.height,o.vy=0));for(const e of L)e.x+=e.dx,(e.x>e.startX+e.range||e.x<e.startX)&&(e.dx*=-1);for(const e of L)o.y+o.height>e.y&&o.y+o.height<e.y+e.height&&o.x+o.width>e.x&&o.x<e.x+e.width&&o.vy>=0&&(o.y=e.y-o.height,o.vy=0,o.onGround=!0,o.x+=e.dx);for(const e of I)!e.collected&&Y(o,e)&&(e.collected=!0,e.type==="coin"?(S++,q(S)):e.type==="heart"&&T<5&&T++);for(const e of G)if(Y(o,e)){j();break}o.y>r.height+100&&j(),o.x+o.width>=te&&!A&&ne(),g=o.x-r.width/2+o.width/2,g=Math.max(0,Math.min(g,w-r.width)),o.x<0&&(o.x=0),o.x+o.width>w&&(o.x=w-o.width)}}let p=localStorage.getItem("fixedGradient")==="true",v=localStorage.getItem("scrollGradient")==="true",O=JSON.parse(localStorage.getItem("fixedGradientColors")||"null")||D(),z=JSON.parse(localStorage.getItem("scrollGradientColors")||"null")||D(),u=localStorage.getItem("imageBg")==="true",x=localStorage.getItem("imageBgUrl")||null,m=null,B=!1;function ae(){fetch("https://pixabay.com/api/?key=51252753-0f1aa9c83b326091b3ad96f88&q=landscape&image_type=photo&orientation=horizontal&safesearch=true&per_page=50").then(n=>n.json()).then(n=>{if(n.hits&&n.hits.length>0){const s=Math.floor(Math.random()*n.hits.length);x=n.hits[s].largeImageURL,x&&(localStorage.setItem("imageBgUrl",x),V())}}).catch(()=>{x=null,B=!1})}function V(){x&&(m=new window.Image,m.crossOrigin="anonymous",m.onload=()=>{B=!0},m.onerror=()=>{B=!1},m.src=x)}x&&V();function D(){function e(){return`hsl(${Math.floor(Math.random()*360)}, 70%, 75%)`}return[e(),e()]}function $(){localStorage.setItem("fixedGradient",String(p)),localStorage.setItem("scrollGradient",String(v)),localStorage.setItem("imageBg",String(u)),localStorage.setItem("fixedGradientColors",JSON.stringify(O)),localStorage.setItem("scrollGradientColors",JSON.stringify(z)),u||(localStorage.removeItem("imageBgUrl"),x=null,m=null,B=!1)}window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("settings-btn"),i=document.getElementById("settings-modal"),n=document.getElementById("close-settings"),s=document.getElementById("fixed-gradient-toggle"),l=document.getElementById("scroll-gradient-toggle"),a=document.getElementById("image-bg-toggle");e&&i&&n&&s&&l&&a&&(e.addEventListener("click",()=>{i.style.display="flex",s.checked=p,l.checked=v,a.checked=u}),n.addEventListener("click",()=>{i.style.display="none"}),s.addEventListener("change",()=>{s.checked?(p=!0,v=!1,u=!1,l.checked=!1,a.checked=!1,O=D()):p=!1,$()}),l.addEventListener("change",()=>{l.checked?(v=!0,p=!1,u=!1,s.checked=!1,a.checked=!1,z=D()):v=!1,$()}),a.addEventListener("change",()=>{a.checked?(u=!0,p=!1,v=!1,s.checked=!1,l.checked=!1,ae()):u=!1,$()}))});let M=[],N=0;function W(){M=[];for(let e=0;e<60;e++){const i=Math.random()*Math.PI*2,n=4+Math.random()*3;M.push({x:r.width/2+(Math.random()-.5)*100,y:r.height/2-80+(Math.random()-.5)*40,vx:Math.cos(i)*n,vy:Math.sin(i)*n-2,color:`hsl(${Math.floor(Math.random()*360)}, 80%, 60%)`,size:8+Math.random()*8,life:60+Math.random()*40,angle:Math.random()*Math.PI*2,spin:(Math.random()-.5)*.2})}N=60}function se(){for(const e of M)e.x+=e.vx,e.y+=e.vy,e.vy+=.15,e.angle+=e.spin,e.life--;M=M.filter(e=>e.life>0&&e.y<r.height+40),N>0&&N--}function he(){for(const e of M)t.save(),t.translate(e.x,e.y),t.rotate(e.angle),t.fillStyle=e.color,t.fillRect(-e.size/2,-e.size/6,e.size,e.size/3),t.restore()}function fe(){if(u&&B&&m){const e=m,i=Math.max(r.width/e.width,r.height/e.height),n=e.width*i,s=e.height*i;let l=-g%n;l>0&&(l-=n);for(let a=l;a<r.width;a+=n)t.drawImage(e,a,0,n,s)}else if(p){const e=t.createLinearGradient(0,0,0,r.height);e.addColorStop(0,O[0]),e.addColorStop(1,O[1]),t.fillStyle=e,t.fillRect(0,0,r.width,r.height)}else if(v){const e=t.createLinearGradient(-g,0,w-g,r.height);e.addColorStop(0,z[0]),e.addColorStop(1,z[1]),t.fillStyle=e,t.fillRect(0,0,r.width,r.height)}else t.fillStyle="#87ceeb",t.fillRect(0,0,r.width,r.height);t.save(),t.translate(-g,0),t.fillStyle="#654321";for(const e of y)"isSlope"in e&&e.isSlope?(t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+e.width,e.endY),t.lineTo(e.x+e.width,e.endY+e.height),t.lineTo(e.x,e.y+e.height),t.closePath(),t.fill()):t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#888";for(const e of L)t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#b5651d";for(const e of k)t.fillRect(e.x,e.y,e.width,e.height);for(const e of I)e.collected||(e.type==="coin"?(t.fillStyle="#0cf",t.beginPath(),t.arc(e.x+e.width/2,e.y+e.height/2,10,0,2*Math.PI),t.fill()):e.type==="heart"&&(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore()));t.fillStyle="#e33";for(const e of G)t.beginPath(),t.moveTo(e.x,e.y+e.height),t.lineTo(e.x+e.width/2,e.y),t.lineTo(e.x+e.width,e.y+e.height),t.closePath(),t.fill();t.restore(),P>0&&Math.floor(P/5)%2===0?t.globalAlpha=.3:t.globalAlpha=1,t.fillStyle="#ff0",t.fillRect(o.x-g,o.y,o.width,o.height),t.globalAlpha=1,t.save(),t.fillStyle="#fff",t.font="20px sans-serif",t.textAlign="left",t.fillText(`Score: ${S}`,20,30),t.fillText(`Top Score: ${C}`,20,60),t.fillText(`Level: ${_}`,20,90);for(let e=0;e<T;e++)t.save(),t.translate(20+e*28,120),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore();t.restore(),X?(t.save(),t.font="bold 48px sans-serif",t.fillStyle="#e33",t.textAlign="center",t.fillText("Game Over",r.width/2,r.height/2-60),t.font="32px sans-serif",t.fillStyle="#fff",t.fillText(`Score: ${S}`,r.width/2,r.height/2-10),t.fillText(`Top Score: ${C}`,r.width/2,r.height/2+40),S>Number(localStorage.getItem("topScore")||"0")&&(t.font="bold 28px sans-serif",t.fillStyle="#0cf",t.fillText("You beat your own top score!",r.width/2,r.height/2+90),N===0&&W()),t.restore(),F()):le(),t.save(),t.translate(-g,0),t.fillStyle="#fff",t.fillRect(f.x,f.y,8,f.height),t.beginPath(),t.moveTo(f.x+8,f.y),t.lineTo(f.x+8+32,f.y+16),t.lineTo(f.x+8,f.y+32),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore(),he()}function H(){re(),se(),fe(),requestAnimationFrame(H)}const h={};window.addEventListener("keydown",e=>{h[e.code]=!0});window.addEventListener("keyup",e=>{h[e.code]=!1});function ce(){if(!/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent))return;const i=document.getElementById("btn-left"),n=document.getElementById("btn-right"),s=document.getElementById("btn-jump");i&&n&&s&&(i.addEventListener("touchstart",l=>{l.preventDefault(),h.ArrowLeft=!0}),i.addEventListener("touchend",l=>{l.preventDefault(),h.ArrowLeft=!1}),n.addEventListener("touchstart",l=>{l.preventDefault(),h.ArrowRight=!0}),n.addEventListener("touchend",l=>{l.preventDefault(),h.ArrowRight=!1}),s.addEventListener("touchstart",l=>{l.preventDefault(),h.Space=!0}),s.addEventListener("touchend",l=>{l.preventDefault(),h.Space=!1}))}ce();H();
