(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const g of r.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&l(g)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}})();class pe{constructor(){this.ws=null,this.isConnected=!1,this.isHost=!1,this.reconnectAttempts=0,this.maxReconnectAttempts=3,this.reconnectDelay=1e3,this.playerId=this.generatePlayerId()}generatePlayerId(){return"player_"+Math.random().toString(36).substr(2,9)}async checkServerAvailable(e=this.getDefaultServerUrl()){try{const i=e.replace("ws://","http://").replace("wss://","https://");let l;return i.includes("/ws")?l=i.replace("/ws","/mp/health"):l=`${i}/health`,(await fetch(l,{method:"GET",signal:AbortSignal.timeout(2e3)})).ok}catch{return console.log("Multiplayer server not available, running in single-player mode"),!1}}getDefaultServerUrl(){const e=window.location.protocol==="https:"?"wss:":"ws:",i=window.location.host,l=window.location.hostname;if(l.includes(".onrender.com"))return`${e}//${i}/ws`;if(i.includes("localhost:5173")||i.includes("127.0.0.1:5173"))return"ws://localhost:3001";if(i.includes(":8080")||l==="localhost"&&i.includes(":80")){const s=i.split(":")[0];return`${e}//${s}:3001`}return e==="wss:"?`${e}//${i}/ws`:`${e}//${i}:3001`}async initialize(e=this.getDefaultServerUrl()){try{return await this.checkServerAvailable(e)?(this.ws=new WebSocket(e),new Promise(l=>{if(!this.ws){l(!1);return}const s=setTimeout(()=>{console.log("Connection timeout, falling back to single-player mode"),this.disconnect(),l(!1)},5e3);this.ws.onopen=()=>{clearTimeout(s),this.isConnected=!0,this.reconnectAttempts=0,console.log("Connected to multiplayer server"),this.send({type:"join",playerId:this.playerId,timestamp:Date.now()}),l(!0)},this.ws.onmessage=r=>{try{const g=JSON.parse(r.data);this.handleMessage(g)}catch(g){console.error("Error parsing message:",g)}},this.ws.onclose=()=>{this.isConnected=!1,console.log("Disconnected from multiplayer server"),this.attemptReconnect(e)},this.ws.onerror=r=>{clearTimeout(s),console.log("WebSocket error, falling back to single-player mode"),this.isConnected=!1,l(!1)}})):(console.log("Multiplayer server not available, continuing in single-player mode"),!1)}catch{return console.log("Failed to initialize multiplayer, continuing in single-player mode"),!1}}attemptReconnect(e){this.reconnectAttempts<this.maxReconnectAttempts?(this.reconnectAttempts++,console.log(`Attempting to reconnect (${this.reconnectAttempts}/${this.maxReconnectAttempts})...`),setTimeout(()=>{this.initialize(e)},this.reconnectDelay*this.reconnectAttempts)):console.log("Max reconnection attempts reached, continuing in single-player mode")}handleMessage(e){switch(e.type){case"gameState":this.onStateUpdate&&this.onStateUpdate(e.gameState);break;case"playerJoined":e.playerId===this.playerId&&(this.isHost=e.isHost||!1),this.onPlayerJoin&&this.onPlayerJoin(e.playerId);break;case"playerLeft":this.onPlayerLeave&&this.onPlayerLeave(e.playerId);break;case"playerUpdate":this._onPlayerUpdate&&this._onPlayerUpdate(e.playerId,e.position);break}}send(e){if(this.ws&&this.isConnected)try{this.ws.send(JSON.stringify(e))}catch(i){console.error("Error sending message:",i),this.isConnected=!1}}updatePlayerPosition(e,i,l,s,r){this.isConnected&&this.send({type:"playerUpdate",playerId:this.playerId,position:{x:e,y:i,width:l,height:s,growLevel:r},timestamp:Date.now()})}collectItem(e){this.isConnected&&this.send({type:"collectItem",playerId:this.playerId,collectibleId:e,timestamp:Date.now()})}onGameStateUpdate(e){this.onStateUpdate=e}onPlayerJoined(e){this.onPlayerJoin=e}onPlayerLeft(e){this.onPlayerLeave=e}onPlayerUpdate(e){this._onPlayerUpdate=e}get connected(){return this.isConnected}get currentPlayerId(){return this.playerId}get isHostPlayer(){return this.isHost}disconnect(){this.ws&&(this.ws.close(),this.ws=null),this.isConnected=!1}ping(){this.isConnected&&this.send({type:"ping",timestamp:Date.now()})}}const L=new pe,a=document.getElementById("gameCanvas"),t=a.getContext("2d"),me=.5,ne=5,p=400,we=60;let ie=0,se=0,he=0,x=localStorage.getItem("speedUnlocked")==="true",U=x?2:1,O=localStorage.getItem("showFpsCounter")!=="false";const C=3200;let w=0;const m=[],X=[],A=[];let u={x:0,y:0,height:80};const o={x:100,y:p-50,width:40,height:50,vx:0,vy:0,onGround:!1,hasDoubleJump:!1,growLevel:0,canDoubleJump:!1};let T=new Map,$=localStorage.getItem("multiplayerEnabled")==="true",re=0;const v=[],Y=[];function Z(){let n=0;const e=[];for(;n<C;){const c=Math.random()<.2?320:160+Math.random()*160;let d;if(Math.random()<.25){const f=(Math.random()<.5?1:-1)*(20+Math.random()*20);d={x:n,y:p,width:c,height:50,endY:p+f,isSlope:!0}}else d={x:n,y:p,width:c,height:50};v.push(d),e.push({x:n+c/2,y:p-30}),Math.random()<.5&&m.push({x:n+c/2-10,y:p-30,width:20,height:20,collected:!1,type:"coin"}),Math.random()<.3&&n>0&&X.push({x:n-40,y:p+35,width:40,height:15}),Math.random()<.2&&n>0&&A.push({x:n-60,y:p-100,width:80,height:20,dx:2,range:120,startX:n-60}),n+=c;const y=60+Math.random()*80;n+=y,Math.random()<.5&&n<C-50&&Y.push({x:n+10,y:p-40,width:40,height:40})}if(e.length>0){const c=Math.floor(Math.random()*e.length),d=e[c];m.push({x:d.x-10,y:d.y,width:20,height:20,collected:!1,type:"heart"})}if(e.length>1){let c,d=0;const y=e.length*3;do c=Math.floor(Math.random()*e.length),d++;while(d<y&&m.some(f=>f.x===e[c].x-10&&f.y===e[c].y));if(d<y){const f=e[c];m.push({x:f.x-10,y:f.y-30,width:20,height:20,collected:!1,type:"doublejump"})}}if(e.length>2){let c,d=0;const y=e.length*3;do c=Math.floor(Math.random()*e.length),d++;while(d<y&&(m.some(f=>f.x===e[c].x-10&&f.y===e[c].y)||m.some(f=>f.x===e[c].x-10&&f.y===e[c].y-30)));if(d<y){const f=e[c];m.push({x:f.x-10,y:f.y-60,width:20,height:20,collected:!1,type:"grow"})}}const i=100;v.some(c=>c.x<=i&&c.x+c.width>=i+40)||v.unshift({x:60,y:p,width:80,height:50});const s=v[v.length-1];let r=s.x+s.width-32,g="isSlope"in s&&s.isSlope?s.endY-u.height:s.y-u.height;u.x=r,u.y=g}Z();function H(n,e){return n.x<e.x+e.width&&n.x+n.width>e.x&&n.y<e.y+e.height&&n.y+n.height>e.y}let E=0,ee=1,xe=C-100,N=0,k=3,q=!1,z=Number(localStorage.getItem("topScore")||"0"),W=!1,F=0;function de(n){n>z&&(z=n,localStorage.setItem("topScore",String(z)))}function ve(){E=0,ee=1,k=3,q=!1,v.length=0,Y.length=0,m.length=0,X.length=0,A.length=0,Z(),te()}function te(){o.x=100,o.y=p-175,o.vx=0,o.vy=0,o.canDoubleJump=!1,oe()}function oe(){o.growLevel===0?(o.width=40,o.height=50):o.growLevel===1?(o.width=60,o.height=75):o.growLevel===2?(o.width=80,o.height=100):o.growLevel>=3&&(o.width=100,o.height=125)}function ae(){if(k--,k<=0){de(E),q=!0,fe();return}o.hasDoubleJump=!1,o.growLevel=0,o.canDoubleJump=!1,oe(),te(),N=30}function fe(){let n=document.getElementById("restart-btn");n?n&&(n.style.display="block",n.style.top="calc(50% + 120px)",n.style.transform="translateX(-50%)"):(n=document.createElement("button"),n.id="restart-btn",n.textContent="Restart",n.style.position="fixed",n.style.left="50%",n.style.top="calc(50% + 120px)",n.style.transform="translateX(-50%)",n.style.fontSize="2em",n.style.padding="16px 32px",n.style.zIndex="100",n.style.background="#222",n.style.color="#fff",n.style.border="2px solid #0cf",n.style.borderRadius="12px",n.style.cursor="pointer",n.onclick=()=>{n?.remove(),ve()},document.body.appendChild(n))}function Se(){const n=document.getElementById("restart-btn");n&&(n.style.display="none")}function be(){v.length=0,Y.length=0,m.length=0,X.length=0,A.length=0,Z(),te(),ee++,b?(B=R(),localStorage.setItem("fixedGradientColors",JSON.stringify(B))):I?(G=R(),localStorage.setItem("scrollGradientColors",JSON.stringify(G))):S&&ge(),le(),W=!1,F=0}function Ie(){le(),W=!0,F=120}function Pe(n){if(q)return;if(W){F--,F<=0&&be();return}if(N>0){N--;return}o.vx=0,(h.ArrowLeft||h.KeyA)&&(o.vx=-ne*U*n*60),(h.ArrowRight||h.KeyD)&&(o.vx=ne*U*n*60);const e=h.ArrowUp||h.Space||h.KeyW;J>0&&J--,e&&J===0&&(o.onGround?(o.vy=-13,o.onGround=!1,o.hasDoubleJump&&(o.canDoubleJump=!0),J=8):o.hasDoubleJump&&o.canDoubleJump&&(o.vy=-13,o.canDoubleJump=!1,J=8));const i=h.KeyT;i&&!ce&&(x=!x,localStorage.setItem("speedUnlocked",String(x)),U=x?2:1),ce=i,o.vy+=me*n*60,o.x+=o.vx,o.y+=o.vy,o.onGround=!1;for(const l of v)if("isSlope"in l&&l.isSlope){if(o.x+o.width>l.x&&o.x<l.x+l.width){const s=(o.x+o.width/2-l.x)/l.width,r=l.y+(l.endY-l.y)*s;o.y+o.height>r&&o.y+o.height<r+l.height&&o.vy>=0&&(o.y=r-o.height,o.vy=0,o.onGround=!0,o.canDoubleJump=o.hasDoubleJump)}}else o.y+o.height>l.y&&o.y+o.height<l.y+l.height&&o.x+o.width>l.x&&o.x<l.x+l.width&&o.vy>=0&&(o.y=l.y-o.height,o.vy=0,o.onGround=!0,o.canDoubleJump=o.hasDoubleJump);for(const l of Y)H(o,l)&&(o.y+o.height-o.vy<=l.y?(o.y=l.y-o.height,o.vy=0,o.onGround=!0):o.x+o.width-o.vx<=l.x?o.x=l.x-o.width:o.x-o.vx>=l.x+l.width?o.x=l.x+l.width:o.y-o.vy>=l.y+l.height&&(o.y=l.y+l.height,o.vy=0));for(const l of A)l.x+=l.dx,(l.x>l.startX+l.range||l.x<l.startX)&&(l.dx*=-1);for(const l of A)o.y+o.height>l.y&&o.y+o.height<l.y+l.height&&o.x+o.width>l.x&&o.x<l.x+l.width&&o.vy>=0&&(o.y=l.y-o.height,o.vy=0,o.onGround=!0,o.x+=l.dx);for(const l of m)if(!l.collected&&H(o,l)){if(l.type==="doublejump"&&o.hasDoubleJump||l.type==="grow"&&o.growLevel>=3)continue;l.collected=!0,l.type==="coin"?(E++,de(E)):l.type==="heart"?k<5&&k++:l.type==="doublejump"?(o.hasDoubleJump=!0,o.canDoubleJump=!1):l.type==="grow"&&(o.growLevel<3&&o.growLevel++,oe())}for(const l of X)if(H(o,l)){ae();break}o.y>a.height+100&&ae(),o.x+o.width>=xe&&!W&&Ie(),w=o.x-a.width/2+o.width/2,w=Math.max(0,Math.min(w,C-a.width)),o.x<0&&(o.x=0),o.x+o.width>C&&(o.x=C-o.width),$&&Date.now()-re>50&&(L.updatePlayerPosition(o.x,o.y,o.width,o.height,o.growLevel),re=Date.now())}function Me(){return/Tesla|QtCarBrowser/i.test(navigator.userAgent)}let _=localStorage.getItem("teslaMode")==="true";function Le(){return Me()||_||/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent)}let b=localStorage.getItem("fixedGradient")==="true",I=localStorage.getItem("scrollGradient")==="true",B=JSON.parse(localStorage.getItem("fixedGradientColors")||"null")||R(),G=JSON.parse(localStorage.getItem("scrollGradientColors")||"null")||R(),S=localStorage.getItem("imageBg")==="true",M=localStorage.getItem("imageBgUrl")||null,P=null,j=!1;function ge(){fetch("https://pixabay.com/api/?key=51252753-0f1aa9c83b326091b3ad96f88&q=landscape&image_type=photo&orientation=horizontal&safesearch=true&per_page=50").then(i=>i.json()).then(i=>{if(i.hits&&i.hits.length>0){const l=Math.floor(Math.random()*i.hits.length);M=i.hits[l].largeImageURL,M&&(localStorage.setItem("imageBgUrl",M),ue())}}).catch(()=>{M=null,j=!1})}function ue(){M&&(P=new window.Image,P.crossOrigin="anonymous",P.onload=()=>{j=!0},P.onerror=()=>{j=!1},P.src=M)}M&&ue();function R(){function n(){return`hsl(${Math.floor(Math.random()*360)}, 70%, 75%)`}return[n(),n()]}function V(){localStorage.setItem("fixedGradient",String(b)),localStorage.setItem("scrollGradient",String(I)),localStorage.setItem("imageBg",String(S)),localStorage.setItem("fixedGradientColors",JSON.stringify(B)),localStorage.setItem("scrollGradientColors",JSON.stringify(G)),S||(localStorage.removeItem("imageBgUrl"),M=null,P=null,j=!1)}const Te="v0.1.8-6-g17f97db-dirty (17f97db, 2025-07-14)";window.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("settings-btn"),e=document.getElementById("settings-modal"),i=document.getElementById("close-settings"),l=document.getElementById("fixed-gradient-toggle"),s=document.getElementById("scroll-gradient-toggle"),r=document.getElementById("image-bg-toggle"),g=document.getElementById("speed-unlock-toggle"),c=document.getElementById("fps-counter-toggle"),d=document.getElementById("tesla-mode-toggle"),y=document.getElementById("multiplayer-toggle");n&&e&&i&&l&&s&&r&&g&&c&&d&&y&&(n.addEventListener("click",()=>{e.style.display="flex",l.checked=b,s.checked=I,r.checked=S,g.checked=x,c.checked=O,d.checked=_,y.checked=$}),i.addEventListener("click",()=>{e.style.display="none"}),l.addEventListener("change",()=>{l.checked?(b=!0,I=!1,S=!1,s.checked=!1,r.checked=!1,B=R()):b=!1,V()}),s.addEventListener("change",()=>{s.checked?(I=!0,b=!1,S=!1,l.checked=!1,r.checked=!1,G=R()):I=!1,V()}),r.addEventListener("change",()=>{r.checked?(S=!0,b=!1,I=!1,l.checked=!1,s.checked=!1,ge()):S=!1,V()}),g.addEventListener("change",()=>{x=g.checked,localStorage.setItem("speedUnlocked",String(x)),U=x?2:1}),c.addEventListener("change",()=>{O=c.checked,localStorage.setItem("showFpsCounter",String(O))}),d.addEventListener("change",()=>{_=d.checked,localStorage.setItem("teslaMode",String(_)),Q()}),y.addEventListener("change",()=>{$=y.checked,localStorage.setItem("multiplayerEnabled",String($)),window.location.reload()}));const f=document.querySelector('#settings-modal [style*="Version: v0.1.8-6-g17f97db-dirty (17f97db, 2025-07-14)"]');f&&(f.textContent=`Version: ${Te}`),Q()});function Q(){const n=document.getElementById("onscreen-controls"),e=document.getElementById("desktop-copyright"),i=Le();n&&(n.style.display=i?"flex":"none"),e&&(e.style.display=i?"none":"block")}function Ce(){const n=document.getElementById("btn-left"),e=document.getElementById("btn-right"),i=document.getElementById("btn-jump");n&&e&&i&&(n.addEventListener("touchstart",l=>{l.preventDefault(),h.ArrowLeft=!0}),n.addEventListener("touchend",l=>{l.preventDefault(),h.ArrowLeft=!1}),e.addEventListener("touchstart",l=>{l.preventDefault(),h.ArrowRight=!0}),e.addEventListener("touchend",l=>{l.preventDefault(),h.ArrowRight=!1}),i.addEventListener("touchstart",l=>{l.preventDefault(),h.Space=!0}),i.addEventListener("touchend",l=>{l.preventDefault(),h.Space=!1}),n.addEventListener("mousedown",l=>{l.preventDefault(),h.ArrowLeft=!0}),n.addEventListener("mouseup",l=>{l.preventDefault(),h.ArrowLeft=!1}),e.addEventListener("mousedown",l=>{l.preventDefault(),h.ArrowRight=!0}),e.addEventListener("mouseup",l=>{l.preventDefault(),h.ArrowRight=!1}),i.addEventListener("mousedown",l=>{l.preventDefault(),h.Space=!0}),i.addEventListener("mouseup",l=>{l.preventDefault(),h.Space=!1}))}Ce();Q();let D=[],K=0;function le(){D=[];for(let n=0;n<60;n++){const e=Math.random()*Math.PI*2,i=4+Math.random()*3;D.push({x:a.width/2+(Math.random()-.5)*100,y:a.height/2-80+(Math.random()-.5)*40,vx:Math.cos(e)*i,vy:Math.sin(e)*i-2,color:`hsl(${Math.floor(Math.random()*360)}, 80%, 60%)`,size:8+Math.random()*8,life:60+Math.random()*40,angle:Math.random()*Math.PI*2,spin:(Math.random()-.5)*.2})}K=60}function Ee(){for(const n of D)n.x+=n.vx,n.y+=n.vy,n.vy+=.15,n.angle+=n.spin,n.life--;D=D.filter(n=>n.life>0&&n.y<a.height+40),K>0&&K--}function ke(){for(const n of D)t.save(),t.translate(n.x,n.y),t.rotate(n.angle),t.fillStyle=n.color,t.fillRect(-n.size/2,-n.size/6,n.size,n.size/3),t.restore()}function De(){if(S&&j&&P){const e=P,i=Math.max(a.width/e.width,a.height/e.height),l=e.width*i,s=e.height*i;let r=-w%l;r>0&&(r-=l);for(let g=r;g<a.width;g+=l)t.drawImage(e,g,0,l,s)}else if(b){const e=t.createLinearGradient(0,0,0,a.height);e.addColorStop(0,B[0]),e.addColorStop(1,B[1]),t.fillStyle=e,t.fillRect(0,0,a.width,a.height)}else if(I){const e=t.createLinearGradient(-w,0,C-w,a.height);e.addColorStop(0,G[0]),e.addColorStop(1,G[1]),t.fillStyle=e,t.fillRect(0,0,a.width,a.height)}else t.fillStyle="#87ceeb",t.fillRect(0,0,a.width,a.height);t.save(),t.translate(-w,0),t.fillStyle="#654321";for(const e of v)"isSlope"in e&&e.isSlope?(t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+e.width,e.endY),t.lineTo(e.x+e.width,e.endY+e.height),t.lineTo(e.x,e.y+e.height),t.closePath(),t.fill()):t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#888";for(const e of A)t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#b5651d";for(const e of Y)t.fillRect(e.x,e.y,e.width,e.height);for(const e of m)e.collected||(e.type==="coin"?(t.fillStyle="#0cf",t.beginPath(),t.arc(e.x+e.width/2,e.y+e.height/2,10,0,2*Math.PI),t.fill()):e.type==="heart"?(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore()):e.type==="doublejump"?(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.rotate(-.3),t.beginPath(),t.moveTo(0,0),t.quadraticCurveTo(10,-10,0,-20),t.quadraticCurveTo(-8,-10,0,0),t.closePath(),t.fillStyle="#fff",t.fill(),t.strokeStyle="#0cf",t.lineWidth=2,t.stroke(),t.restore()):e.type==="grow"&&(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.lineTo(10,10),t.arc(0,10,10,0,Math.PI,!0),t.closePath(),t.fillStyle="#fff",t.fill(),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore()));t.fillStyle="#e33";for(const e of X)t.beginPath(),t.moveTo(e.x,e.y+e.height),t.lineTo(e.x+e.width/2,e.y),t.lineTo(e.x+e.width,e.y+e.height),t.closePath(),t.fill();t.restore(),N>0&&Math.floor(N/5)%2===0?t.globalAlpha=.3:t.globalAlpha=1,t.fillStyle="#ff0",t.fillRect(o.x-w,o.y,o.width,o.height),t.globalAlpha=1,t.save(),t.fillStyle="#0cf";for(const e of T.values())t.fillRect(e.x-w,e.y,e.width,e.height);if(t.restore(),t.save(),t.fillStyle="#fff",t.font="20px sans-serif",t.textAlign="left",t.fillText(`Score: ${E}`,20,30),t.fillText(`Top Score: ${z}`,20,60),t.fillText(`Level: ${ee}`,20,90),O&&t.fillText(`FPS: ${he}`,20,120),x){t.fillStyle="#0cf";const e=O?150:120;t.fillText(`Speed: ${U}x`,20,e)}for(let e=0;e<k;e++)t.save(),t.translate(20+e*28,120),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore();let n=20+k*28+20;o.hasDoubleJump&&(t.save(),t.translate(n,120),t.rotate(-.3),t.beginPath(),t.moveTo(0,0),t.quadraticCurveTo(10,-10,0,-20),t.quadraticCurveTo(-8,-10,0,0),t.closePath(),t.fillStyle="#fff",t.fill(),t.strokeStyle="#0cf",t.lineWidth=2,t.stroke(),t.restore(),n+=36);for(let e=0;e<o.growLevel;e++)t.save(),t.translate(n,120),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.lineTo(10,10),t.arc(0,10,10,0,Math.PI,!0),t.closePath(),t.fillStyle="#fff",t.fill(),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore(),n+=36;t.restore(),q?(t.save(),t.fillStyle="rgba(0, 0, 0, 0.7)",t.fillRect(a.width/2-200,a.height/2-100,400,200),t.strokeStyle="#444",t.lineWidth=2,t.strokeRect(a.width/2-200,a.height/2-100,400,200),t.font="bold 48px sans-serif",t.fillStyle="#e33",t.textAlign="center",t.fillText("Game Over",a.width/2,a.height/2-60),t.font="32px sans-serif",t.fillStyle="#fff",t.fillText(`Score: ${E}`,a.width/2,a.height/2-10),t.fillText(`Top Score: ${z}`,a.width/2,a.height/2+40),E>Number(localStorage.getItem("topScore")||"0")&&(t.font="bold 28px sans-serif",t.fillStyle="#0cf",t.fillText("You beat your own top score!",a.width/2,a.height/2+90),K===0&&le()),t.restore(),fe()):Se(),t.save(),t.translate(-w,0),t.fillStyle="#fff",t.fillRect(u.x,u.y,8,u.height),t.beginPath(),t.moveTo(u.x+8,u.y),t.lineTo(u.x+8+32,u.y+16),t.lineTo(u.x+8,u.y+32),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore(),ke()}function ye(){const n=performance.now(),e=n-ie;De(),e>=1e3/we&&(se++,se%60===0&&(he=Math.round(1e3/(e/60))),Pe(e/1e3),Ee(),ie=n),requestAnimationFrame(ye)}const h={};let ce=!1,J=0;window.addEventListener("keydown",n=>{h[n.code]=!0});window.addEventListener("keyup",n=>{h[n.code]=!1});$?(async()=>{try{await L.initialize()?(console.log("Multiplayer enabled!"),L.onGameStateUpdate(e=>{T.clear(),e.players.forEach(i=>{i.id!==L.currentPlayerId&&T.set(i.id,i)})}),L.onPlayerJoined(e=>{console.log(`Player ${e} joined the game!`)}),L.onPlayerLeft(e=>{console.log(`Player ${e} left the game`),T.delete(e)}),L.onPlayerUpdate((e,i)=>{if(T.has(e)){const l=T.get(e);Object.assign(l,i)}else T.set(e,{id:e,...i})})):console.log("Running in single-player mode")}catch{console.log("Multiplayer initialization failed, continuing in single-player mode")}})():console.log("Running in single-player mode");ye();
