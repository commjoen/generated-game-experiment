(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const m of s.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const r=document.getElementById("gameCanvas"),t=r.getContext("2d"),oe=.5,_=4,g=400,I=3200;let p=0;const u=[],A=[],C=[];let c={x:0,y:0,height:80};const l={x:100,y:g-50,width:40,height:50,vx:0,vy:0,onGround:!1,hasDoubleJump:!1,growLevel:0,canDoubleJump:!1},x=[],R=[];function K(){let o=0;const e=[];for(;o<I;){const h=Math.random()<.2?320:160+Math.random()*160;let d;if(Math.random()<.25){const le=(Math.random()<.5?1:-1)*(20+Math.random()*20);d={x:o,y:g,width:h,height:50,endY:g+le,isSlope:!0}}else d={x:o,y:g,width:h,height:50};x.push(d),e.push({x:o+h/2,y:g-30}),Math.random()<.5&&u.push({x:o+h/2-10,y:g-30,width:20,height:20,collected:!1,type:"coin"}),Math.random()<.3&&o>0&&A.push({x:o-40,y:g+35,width:40,height:15}),Math.random()<.2&&o>0&&C.push({x:o-60,y:g-100,width:80,height:20,dx:2,range:120,startX:o-60}),o+=h;const y=60+Math.random()*80;o+=y,Math.random()<.5&&o<I-50&&R.push({x:o+10,y:g-40,width:40,height:40})}if(e.length>0){const h=Math.floor(Math.random()*e.length),d=e[h];u.push({x:d.x-10,y:d.y,width:20,height:20,collected:!1,type:"heart"})}if(e.length>1){let h;do h=Math.floor(Math.random()*e.length);while(u.some(y=>y.x===e[h].x-10&&y.y===e[h].y));const d=e[h];u.push({x:d.x-10,y:d.y-30,width:20,height:20,collected:!1,type:"doublejump"})}if(e.length>2){let h;do h=Math.floor(Math.random()*e.length);while(u.some(y=>y.x===e[h].x-10&&y.y===e[h].y)||u.some(y=>y.x===e[h].x-10&&y.y===e[h].y-30));const d=e[h];u.push({x:d.x-10,y:d.y-60,width:20,height:20,collected:!1,type:"grow"})}const n=100;x.some(h=>h.x<=n&&h.x+h.width>=n+40)||x.unshift({x:60,y:g,width:80,height:50});const i=x[x.length-1];let s=i.x+i.width-32,m="isSlope"in i&&i.isSlope?i.endY-c.height:i.y-c.height;c.x=s,c.y=m}K();function Y(o,e){return o.x<e.x+e.width&&o.x+o.width>e.x&&o.y<e.y+e.height&&o.y+o.height>e.y}let P=0,W=1,ie=I-100,k=0,L=3,X=!1,B=Number(localStorage.getItem("topScore")||"0"),O=!1,z=0;function H(o){o>B&&(B=o,localStorage.setItem("topScore",String(B)))}function ne(){P=0,W=1,L=3,X=!1,x.length=0,R.length=0,u.length=0,A.length=0,C.length=0,K(),$()}function $(){l.x=100,l.y=g-50,l.vx=0,l.vy=0,l.canDoubleJump=!1,q()}function q(){l.growLevel===0?(l.width=40,l.height=50):l.growLevel===1?(l.width=60,l.height=75):l.growLevel===2?(l.width=80,l.height=100):l.growLevel>=3&&(l.width=100,l.height=125)}function F(){if(L--,L<=0){H(P),X=!0,Q();return}l.hasDoubleJump=!1,l.growLevel=0,l.canDoubleJump=!1,q(),$(),k=30}function Q(){let o=document.getElementById("restart-btn");o?o&&(o.style.display="block",o.style.top="calc(50% + 120px)",o.style.transform="translateX(-50%)"):(o=document.createElement("button"),o.id="restart-btn",o.textContent="Restart",o.style.position="fixed",o.style.left="50%",o.style.top="calc(50% + 120px)",o.style.transform="translateX(-50%)",o.style.fontSize="2em",o.style.padding="16px 32px",o.style.zIndex="100",o.style.background="#222",o.style.color="#fff",o.style.border="2px solid #0cf",o.style.borderRadius="12px",o.style.cursor="pointer",o.onclick=()=>{o?.remove(),ne()},document.body.appendChild(o))}function re(){const o=document.getElementById("restart-btn");o&&(o.style.display="none")}function ae(){x.length=0,R.length=0,u.length=0,A.length=0,C.length=0,K(),$(),W++,w?(E=D(),localStorage.setItem("fixedGradientColors",JSON.stringify(E))):b?(G=D(),localStorage.setItem("scrollGradientColors",JSON.stringify(G))):v&&Z(),U(),O=!1,z=0}function se(){U(),O=!0,z=120}function he(){if(X)return;if(O){z--,z<=0&&ae();return}if(k>0){k--;return}l.vx=0,(f.ArrowLeft||f.KeyA)&&(l.vx=-_),(f.ArrowRight||f.KeyD)&&(l.vx=_);const o=f.ArrowUp||f.Space||f.KeyW;o&&!V&&(l.onGround?(l.vy=-12,l.onGround=!1,l.hasDoubleJump&&(l.canDoubleJump=!0)):l.hasDoubleJump&&l.canDoubleJump&&(l.vy=-12,l.canDoubleJump=!1)),V=o,l.vy+=oe,l.x+=l.vx,l.y+=l.vy,l.onGround=!1;for(const e of x)if("isSlope"in e&&e.isSlope){if(l.x+l.width>e.x&&l.x<e.x+e.width){const n=(l.x+l.width/2-e.x)/e.width,a=e.y+(e.endY-e.y)*n;l.y+l.height>a&&l.y+l.height<a+e.height&&l.vy>=0&&(l.y=a-l.height,l.vy=0,l.onGround=!0,l.canDoubleJump=l.hasDoubleJump)}}else l.y+l.height>e.y&&l.y+l.height<e.y+e.height&&l.x+l.width>e.x&&l.x<e.x+e.width&&l.vy>=0&&(l.y=e.y-l.height,l.vy=0,l.onGround=!0,l.canDoubleJump=l.hasDoubleJump);for(const e of R)Y(l,e)&&(l.y+l.height-l.vy<=e.y?(l.y=e.y-l.height,l.vy=0,l.onGround=!0):l.x+l.width-l.vx<=e.x?l.x=e.x-l.width:l.x-l.vx>=e.x+e.width?l.x=e.x+e.width:l.y-l.vy>=e.y+e.height&&(l.y=e.y+e.height,l.vy=0));for(const e of C)e.x+=e.dx,(e.x>e.startX+e.range||e.x<e.startX)&&(e.dx*=-1);for(const e of C)l.y+l.height>e.y&&l.y+l.height<e.y+e.height&&l.x+l.width>e.x&&l.x<e.x+e.width&&l.vy>=0&&(l.y=e.y-l.height,l.vy=0,l.onGround=!0,l.x+=e.dx);for(const e of u)if(!e.collected&&Y(l,e)){if(e.type==="doublejump"&&l.hasDoubleJump||e.type==="grow"&&l.growLevel>=3)continue;e.collected=!0,e.type==="coin"?(P++,H(P)):e.type==="heart"?L<5&&L++:e.type==="doublejump"?(l.hasDoubleJump=!0,l.canDoubleJump=!1):e.type==="grow"&&(l.growLevel<3&&l.growLevel++,q())}for(const e of A)if(Y(l,e)){F();break}l.y>r.height+100&&F(),l.x+l.width>=ie&&!O&&se(),p=l.x-r.width/2+l.width/2,p=Math.max(0,Math.min(p,I-r.width)),l.x<0&&(l.x=0),l.x+l.width>I&&(l.x=I-l.width)}let w=localStorage.getItem("fixedGradient")==="true",b=localStorage.getItem("scrollGradient")==="true",E=JSON.parse(localStorage.getItem("fixedGradientColors")||"null")||D(),G=JSON.parse(localStorage.getItem("scrollGradientColors")||"null")||D(),v=localStorage.getItem("imageBg")==="true",M=localStorage.getItem("imageBgUrl")||null,S=null,J=!1;function Z(){fetch("https://pixabay.com/api/?key=51252753-0f1aa9c83b326091b3ad96f88&q=landscape&image_type=photo&orientation=horizontal&safesearch=true&per_page=50").then(n=>n.json()).then(n=>{if(n.hits&&n.hits.length>0){const a=Math.floor(Math.random()*n.hits.length);M=n.hits[a].largeImageURL,M&&(localStorage.setItem("imageBgUrl",M),ee())}}).catch(()=>{M=null,J=!1})}function ee(){M&&(S=new window.Image,S.crossOrigin="anonymous",S.onload=()=>{J=!0},S.onerror=()=>{J=!1},S.src=M)}M&&ee();function D(){function o(){return`hsl(${Math.floor(Math.random()*360)}, 70%, 75%)`}return[o(),o()]}function j(){localStorage.setItem("fixedGradient",String(w)),localStorage.setItem("scrollGradient",String(b)),localStorage.setItem("imageBg",String(v)),localStorage.setItem("fixedGradientColors",JSON.stringify(E)),localStorage.setItem("scrollGradientColors",JSON.stringify(G)),v||(localStorage.removeItem("imageBgUrl"),M=null,S=null,J=!1)}window.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("settings-btn"),e=document.getElementById("settings-modal"),n=document.getElementById("close-settings"),a=document.getElementById("fixed-gradient-toggle"),i=document.getElementById("scroll-gradient-toggle"),s=document.getElementById("image-bg-toggle");o&&e&&n&&a&&i&&s&&(o.addEventListener("click",()=>{e.style.display="flex",a.checked=w,i.checked=b,s.checked=v}),n.addEventListener("click",()=>{e.style.display="none"}),a.addEventListener("change",()=>{a.checked?(w=!0,b=!1,v=!1,i.checked=!1,s.checked=!1,E=D()):w=!1,j()}),i.addEventListener("change",()=>{i.checked?(b=!0,w=!1,v=!1,a.checked=!1,s.checked=!1,G=D()):b=!1,j()}),s.addEventListener("change",()=>{s.checked?(v=!0,w=!1,b=!1,a.checked=!1,i.checked=!1,Z()):v=!1,j()}))});let T=[],N=0;function U(){T=[];for(let o=0;o<60;o++){const e=Math.random()*Math.PI*2,n=4+Math.random()*3;T.push({x:r.width/2+(Math.random()-.5)*100,y:r.height/2-80+(Math.random()-.5)*40,vx:Math.cos(e)*n,vy:Math.sin(e)*n-2,color:`hsl(${Math.floor(Math.random()*360)}, 80%, 60%)`,size:8+Math.random()*8,life:60+Math.random()*40,angle:Math.random()*Math.PI*2,spin:(Math.random()-.5)*.2})}N=60}function fe(){for(const o of T)o.x+=o.vx,o.y+=o.vy,o.vy+=.15,o.angle+=o.spin,o.life--;T=T.filter(o=>o.life>0&&o.y<r.height+40),N>0&&N--}function ce(){for(const o of T)t.save(),t.translate(o.x,o.y),t.rotate(o.angle),t.fillStyle=o.color,t.fillRect(-o.size/2,-o.size/6,o.size,o.size/3),t.restore()}function de(){if(v&&J&&S){const e=S,n=Math.max(r.width/e.width,r.height/e.height),a=e.width*n,i=e.height*n;let s=-p%a;s>0&&(s-=a);for(let m=s;m<r.width;m+=a)t.drawImage(e,m,0,a,i)}else if(w){const e=t.createLinearGradient(0,0,0,r.height);e.addColorStop(0,E[0]),e.addColorStop(1,E[1]),t.fillStyle=e,t.fillRect(0,0,r.width,r.height)}else if(b){const e=t.createLinearGradient(-p,0,I-p,r.height);e.addColorStop(0,G[0]),e.addColorStop(1,G[1]),t.fillStyle=e,t.fillRect(0,0,r.width,r.height)}else t.fillStyle="#87ceeb",t.fillRect(0,0,r.width,r.height);t.save(),t.translate(-p,0),t.fillStyle="#654321";for(const e of x)"isSlope"in e&&e.isSlope?(t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+e.width,e.endY),t.lineTo(e.x+e.width,e.endY+e.height),t.lineTo(e.x,e.y+e.height),t.closePath(),t.fill()):t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#888";for(const e of C)t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#b5651d";for(const e of R)t.fillRect(e.x,e.y,e.width,e.height);for(const e of u)e.collected||(e.type==="coin"?(t.fillStyle="#0cf",t.beginPath(),t.arc(e.x+e.width/2,e.y+e.height/2,10,0,2*Math.PI),t.fill()):e.type==="heart"?(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore()):e.type==="doublejump"?(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.rotate(-.3),t.beginPath(),t.moveTo(0,0),t.quadraticCurveTo(10,-10,0,-20),t.quadraticCurveTo(-8,-10,0,0),t.closePath(),t.fillStyle="#fff",t.fill(),t.strokeStyle="#0cf",t.lineWidth=2,t.stroke(),t.restore()):e.type==="grow"&&(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.lineTo(10,10),t.arc(0,10,10,0,Math.PI,!0),t.closePath(),t.fillStyle="#fff",t.fill(),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore()));t.fillStyle="#e33";for(const e of A)t.beginPath(),t.moveTo(e.x,e.y+e.height),t.lineTo(e.x+e.width/2,e.y),t.lineTo(e.x+e.width,e.y+e.height),t.closePath(),t.fill();t.restore(),k>0&&Math.floor(k/5)%2===0?t.globalAlpha=.3:t.globalAlpha=1,t.fillStyle="#ff0",t.fillRect(l.x-p,l.y,l.width,l.height),t.globalAlpha=1,t.save(),t.fillStyle="#fff",t.font="20px sans-serif",t.textAlign="left",t.fillText(`Score: ${P}`,20,30),t.fillText(`Top Score: ${B}`,20,60),t.fillText(`Level: ${W}`,20,90);for(let e=0;e<L;e++)t.save(),t.translate(20+e*28,120),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore();let o=20+L*28+20;l.hasDoubleJump&&(t.save(),t.translate(o,120),t.rotate(-.3),t.beginPath(),t.moveTo(0,0),t.quadraticCurveTo(10,-10,0,-20),t.quadraticCurveTo(-8,-10,0,0),t.closePath(),t.fillStyle="#fff",t.fill(),t.strokeStyle="#0cf",t.lineWidth=2,t.stroke(),t.restore(),o+=36);for(let e=0;e<l.growLevel;e++)t.save(),t.translate(o,120),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.lineTo(10,10),t.arc(0,10,10,0,Math.PI,!0),t.closePath(),t.fillStyle="#fff",t.fill(),t.beginPath(),t.arc(0,0,10,Math.PI,2*Math.PI),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore(),o+=36;t.restore(),X?(t.save(),t.font="bold 48px sans-serif",t.fillStyle="#e33",t.textAlign="center",t.fillText("Game Over",r.width/2,r.height/2-60),t.font="32px sans-serif",t.fillStyle="#fff",t.fillText(`Score: ${P}`,r.width/2,r.height/2-10),t.fillText(`Top Score: ${B}`,r.width/2,r.height/2+40),P>Number(localStorage.getItem("topScore")||"0")&&(t.font="bold 28px sans-serif",t.fillStyle="#0cf",t.fillText("You beat your own top score!",r.width/2,r.height/2+90),N===0&&U()),t.restore(),Q()):re(),t.save(),t.translate(-p,0),t.fillStyle="#fff",t.fillRect(c.x,c.y,8,c.height),t.beginPath(),t.moveTo(c.x+8,c.y),t.lineTo(c.x+8+32,c.y+16),t.lineTo(c.x+8,c.y+32),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore(),ce()}function te(){he(),fe(),de(),requestAnimationFrame(te)}const f={};let V=!1;window.addEventListener("keydown",o=>{f[o.code]=!0});window.addEventListener("keyup",o=>{f[o.code]=!1});function ge(){if(!/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent))return;const e=document.getElementById("btn-left"),n=document.getElementById("btn-right"),a=document.getElementById("btn-jump");e&&n&&a&&(e.addEventListener("touchstart",i=>{i.preventDefault(),f.ArrowLeft=!0}),e.addEventListener("touchend",i=>{i.preventDefault(),f.ArrowLeft=!1}),n.addEventListener("touchstart",i=>{i.preventDefault(),f.ArrowRight=!0}),n.addEventListener("touchend",i=>{i.preventDefault(),f.ArrowRight=!1}),a.addEventListener("touchstart",i=>{i.preventDefault(),f.Space=!0}),a.addEventListener("touchend",i=>{i.preventDefault(),f.Space=!1}))}ge();te();
