(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const d of n)if(d.type==="childList")for(const A of d.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&i(A)}).observe(document,{childList:!0,subtree:!0});function a(n){const d={};return n.integrity&&(d.integrity=n.integrity),n.referrerPolicy&&(d.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?d.credentials="include":n.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(n){if(n.ep)return;n.ep=!0;const d=a(n);fetch(n.href,d)}})();const s=document.getElementById("gameCanvas"),o=s.getContext("2d"),J=.5,O=4,c=400,y=3200;let g=0;const v=[],w=[],x=[],t={x:100,y:c-50,width:40,height:50,vx:0,vy:0,onGround:!1},r={};window.addEventListener("keydown",e=>{r[e.code]=!0});window.addEventListener("keyup",e=>{r[e.code]=!1});function $(){if(!/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent))return;const l=document.getElementById("btn-left"),a=document.getElementById("btn-right"),i=document.getElementById("btn-jump");l&&a&&i&&(l.addEventListener("touchstart",n=>{n.preventDefault(),r.ArrowLeft=!0}),l.addEventListener("touchend",n=>{n.preventDefault(),r.ArrowLeft=!1}),a.addEventListener("touchstart",n=>{n.preventDefault(),r.ArrowRight=!0}),a.addEventListener("touchend",n=>{n.preventDefault(),r.ArrowRight=!1}),i.addEventListener("touchstart",n=>{n.preventDefault(),r.Space=!0}),i.addEventListener("touchend",n=>{n.preventDefault(),r.Space=!1}))}$();const u=[],S=[];function k(){let e=0;for(;e<y;){const i=Math.random()<.2?320:160+Math.random()*160;u.push({x:e,y:c,width:i,height:50}),Math.random()<.5&&v.push({x:e+i/2-10,y:c-30,width:20,height:20,collected:!1}),Math.random()<.3&&e>0&&w.push({x:e-40,y:c+35,width:40,height:15}),Math.random()<.2&&e>0&&x.push({x:e-60,y:c-100,width:80,height:20,dx:2,range:120,startX:e-60}),e+=i;const n=60+Math.random()*80;e+=n,Math.random()<.5&&e<y-50&&S.push({x:e+10,y:c-40,width:40,height:40})}const l=100;u.some(i=>i.x<=l&&i.x+i.width>=l+40)||u.unshift({x:60,y:c,width:80,height:50})}k();function C(e,l){return e.x<l.x+l.width&&e.x+e.width>l.x&&e.y<l.y+l.height&&e.y+e.height>l.y}let p=0,B=1,K=y-100,m=0,E=3,M=!1,b=Number(localStorage.getItem("topScore")||"0");function D(e){e>b&&(b=e,localStorage.setItem("topScore",String(b)))}function W(){p=0,B=1,E=3,M=!1,u.length=0,S.length=0,v.length=0,w.length=0,x.length=0,k(),R()}function R(){t.x=100,t.y=c-50,t.vx=0,t.vy=0}function P(){if(E--,E<=0){D(p),M=!0,N();return}R(),m=30}function N(){let e=document.getElementById("restart-btn");e?e&&(e.style.display="block"):(e=document.createElement("button"),e.id="restart-btn",e.textContent="Restart",e.style.position="fixed",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)",e.style.fontSize="2em",e.style.padding="16px 32px",e.style.zIndex="100",e.style.background="#222",e.style.color="#fff",e.style.border="2px solid #0cf",e.style.borderRadius="12px",e.style.cursor="pointer",e.onclick=()=>{e?.remove(),W()},document.body.appendChild(e))}function V(){const e=document.getElementById("restart-btn");e&&(e.style.display="none")}function _(){u.length=0,S.length=0,v.length=0,w.length=0,x.length=0,k(),R(),p=0,B++}function q(){if(!M){if(m>0){m--;return}t.vx=0,(r.ArrowLeft||r.KeyA)&&(t.vx=-O),(r.ArrowRight||r.KeyD)&&(t.vx=O),(r.ArrowUp||r.Space||r.KeyW)&&t.onGround&&(t.vy=-12,t.onGround=!1),t.vy+=J,t.x+=t.vx,t.y+=t.vy,t.onGround=!1;for(const e of u)t.y+t.height>e.y&&t.y+t.height<e.y+e.height&&t.x+t.width>e.x&&t.x<e.x+e.width&&t.vy>=0&&(t.y=e.y-t.height,t.vy=0,t.onGround=!0);for(const e of S)C(t,e)&&(t.y+t.height-t.vy<=e.y?(t.y=e.y-t.height,t.vy=0,t.onGround=!0):t.x+t.width-t.vx<=e.x?t.x=e.x-t.width:t.x-t.vx>=e.x+e.width?t.x=e.x+e.width:t.y-t.vy>=e.y+e.height&&(t.y=e.y+e.height,t.vy=0));for(const e of x)e.x+=e.dx,(e.x>e.startX+e.range||e.x<e.startX)&&(e.dx*=-1);for(const e of x)t.y+t.height>e.y&&t.y+t.height<e.y+e.height&&t.x+t.width>e.x&&t.x<e.x+e.width&&t.vy>=0&&(t.y=e.y-t.height,t.vy=0,t.onGround=!0,t.x+=e.dx);for(const e of v)!e.collected&&C(t,e)&&(e.collected=!0,p++,D(p));for(const e of w)if(C(t,e)){P();break}t.y>s.height+100&&P(),t.x+t.width>=K&&_(),g=t.x-s.width/2+t.width/2,g=Math.max(0,Math.min(g,y-s.width)),t.x<0&&(t.x=0),t.x+t.width>y&&(t.x=y-t.width)}}let f=localStorage.getItem("fixedGradient")==="true",h=localStorage.getItem("scrollGradient")==="true",L=JSON.parse(localStorage.getItem("fixedGradientColors")||"null")||I(),G=JSON.parse(localStorage.getItem("scrollGradientColors")||"null")||I();function I(){function e(){return`hsl(${Math.floor(Math.random()*360)}, 70%, 75%)`}return[e(),e()]}function T(){localStorage.setItem("fixedGradient",String(f)),localStorage.setItem("scrollGradient",String(h)),localStorage.setItem("fixedGradientColors",JSON.stringify(L)),localStorage.setItem("scrollGradientColors",JSON.stringify(G))}window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("settings-btn"),l=document.getElementById("settings-modal"),a=document.getElementById("close-settings"),i=document.getElementById("fixed-gradient-toggle"),n=document.getElementById("scroll-gradient-toggle");e&&l&&a&&i&&n&&(e.addEventListener("click",()=>{l.style.display="flex",i.checked=f,n.checked=h,n.disabled=f,i.disabled=h}),a.addEventListener("click",()=>{l.style.display="none"}),i.addEventListener("change",()=>{f=i.checked,f?(L=I(),h=!1,n.checked=!1,n.disabled=!0):n.disabled=!1,T()}),n.addEventListener("change",()=>{h=n.checked,h?(G=I(),f=!1,i.checked=!1,i.disabled=!0):i.disabled=!1,T()}))});function z(){if(f){const e=o.createLinearGradient(0,0,0,s.height);e.addColorStop(0,L[0]),e.addColorStop(1,L[1]),o.fillStyle=e,o.fillRect(0,0,s.width,s.height)}else if(h){const e=o.createLinearGradient(-g,0,y-g,s.height);e.addColorStop(0,G[0]),e.addColorStop(1,G[1]),o.fillStyle=e,o.fillRect(0,0,s.width,s.height)}else o.fillStyle="#87ceeb",o.fillRect(0,0,s.width,s.height);o.save(),o.translate(-g,0),o.fillStyle="#654321";for(const e of u)o.fillRect(e.x,e.y,e.width,e.height);o.fillStyle="#888";for(const e of x)o.fillRect(e.x,e.y,e.width,e.height);o.fillStyle="#b5651d";for(const e of S)o.fillRect(e.x,e.y,e.width,e.height);o.fillStyle="#0cf";for(const e of v)e.collected||(o.beginPath(),o.arc(e.x+e.width/2,e.y+e.height/2,10,0,2*Math.PI),o.fill());o.fillStyle="#e33";for(const e of w)o.beginPath(),o.moveTo(e.x,e.y+e.height),o.lineTo(e.x+e.width/2,e.y),o.lineTo(e.x+e.width,e.y+e.height),o.closePath(),o.fill();o.restore(),m>0&&Math.floor(m/5)%2===0?o.globalAlpha=.3:o.globalAlpha=1,o.fillStyle="#ff0",o.fillRect(t.x-g,t.y,t.width,t.height),o.globalAlpha=1,o.save(),o.fillStyle="#fff",o.font="20px sans-serif",o.textAlign="left",o.fillText(`Score: ${p}`,20,30),o.fillText(`Top Score: ${b}`,20,60),o.fillText(`Level: ${B}`,20,90),o.fillText(`Lives: ${E}`,20,120),o.restore(),M?(o.save(),o.font="bold 48px sans-serif",o.fillStyle="#e33",o.textAlign="center",o.fillText("Game Over",s.width/2,s.height/2-60),o.restore(),N()):V()}function X(){q(),z(),requestAnimationFrame(X)}X();
