(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const w of l.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&s(w)}).observe(document,{childList:!0,subtree:!0});function h(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(o){if(o.ep)return;o.ep=!0;const l=h(o);fetch(o.href,l)}})();const d=document.getElementById("gameCanvas"),i=d.getContext("2d"),D=.5,E=4,f=400,c=2400;let a=0;const g=[],x=[],y=[],t={x:100,y:f-50,width:40,height:50,vx:0,vy:0,onGround:!1},r={};window.addEventListener("keydown",e=>{r[e.code]=!0});window.addEventListener("keyup",e=>{r[e.code]=!1});function R(){if(!/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent))return;const n=document.getElementById("btn-left"),h=document.getElementById("btn-right"),s=document.getElementById("btn-jump");n&&h&&s&&(n.addEventListener("touchstart",o=>{o.preventDefault(),r.ArrowLeft=!0}),n.addEventListener("touchend",o=>{o.preventDefault(),r.ArrowLeft=!1}),h.addEventListener("touchstart",o=>{o.preventDefault(),r.ArrowRight=!0}),h.addEventListener("touchend",o=>{o.preventDefault(),r.ArrowRight=!1}),s.addEventListener("touchstart",o=>{o.preventDefault(),r.Space=!0}),s.addEventListener("touchend",o=>{o.preventDefault(),r.Space=!1}))}R();const p=[],v=[];function M(){let e=0;for(;e<c;){const n=Math.random()<.2?80:160;p.push({x:e,y:f,width:n,height:50}),Math.random()<.5&&g.push({x:e+n/2-10,y:f-30,width:20,height:20,collected:!1}),Math.random()<.3&&e>0&&x.push({x:e-40,y:f+35,width:40,height:15}),Math.random()<.2&&e>0&&y.push({x:e-60,y:f-100,width:80,height:20,dx:2,range:120,startX:e-60}),e+=n;const h=60+Math.random()*80;e+=h,Math.random()<.5&&e<c-50&&v.push({x:e+10,y:f-40,width:40,height:40})}}M();function m(e,n){return e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y}let L=0,A=1,G=c-100,u=0;function P(){t.x=100,t.y=f-50,t.vx=0,t.vy=0}function b(){P(),u=30}function I(){p.length=0,v.length=0,g.length=0,x.length=0,y.length=0,M(),P(),L=0,A++}function O(){if(u>0){u--;return}t.vx=0,(r.ArrowLeft||r.KeyA)&&(t.vx=-E),(r.ArrowRight||r.KeyD)&&(t.vx=E),(r.ArrowUp||r.Space||r.KeyW)&&t.onGround&&(t.vy=-12,t.onGround=!1),t.vy+=D,t.x+=t.vx,t.y+=t.vy,t.onGround=!1;for(const e of p)t.y+t.height>e.y&&t.y+t.height<e.y+e.height&&t.x+t.width>e.x&&t.x<e.x+e.width&&t.vy>=0&&(t.y=e.y-t.height,t.vy=0,t.onGround=!0);for(const e of v)m(t,e)&&(t.y+t.height-t.vy<=e.y?(t.y=e.y-t.height,t.vy=0,t.onGround=!0):t.x+t.width-t.vx<=e.x?t.x=e.x-t.width:t.x-t.vx>=e.x+e.width?t.x=e.x+e.width:t.y-t.vy>=e.y+e.height&&(t.y=e.y+e.height,t.vy=0));for(const e of y)e.x+=e.dx,(e.x>e.startX+e.range||e.x<e.startX)&&(e.dx*=-1);for(const e of y)t.y+t.height>e.y&&t.y+t.height<e.y+e.height&&t.x+t.width>e.x&&t.x<e.x+e.width&&t.vy>=0&&(t.y=e.y-t.height,t.vy=0,t.onGround=!0,t.x+=e.dx);for(const e of g)!e.collected&&m(t,e)&&(e.collected=!0,L++);for(const e of x)if(m(t,e)){b();break}t.y>d.height+100&&b(),t.x+t.width>=G&&I(),a=t.x-d.width/2+t.width/2,a=Math.max(0,Math.min(a,c-d.width)),t.x<0&&(t.x=0),t.x+t.width>c&&(t.x=c-t.width)}function T(){i.clearRect(0,0,d.width,d.height),i.save(),i.translate(-a,0),i.fillStyle="#654321";for(const e of p)i.fillRect(e.x,e.y,e.width,e.height);i.fillStyle="#888";for(const e of y)i.fillRect(e.x,e.y,e.width,e.height);i.fillStyle="#b5651d";for(const e of v)i.fillRect(e.x,e.y,e.width,e.height);i.fillStyle="#0cf";for(const e of g)e.collected||(i.beginPath(),i.arc(e.x+e.width/2,e.y+e.height/2,10,0,2*Math.PI),i.fill());i.fillStyle="#e33";for(const e of x)i.beginPath(),i.moveTo(e.x,e.y+e.height),i.lineTo(e.x+e.width/2,e.y),i.lineTo(e.x+e.width,e.y+e.height),i.closePath(),i.fill();i.restore(),u>0&&Math.floor(u/5)%2===0?i.globalAlpha=.3:i.globalAlpha=1,i.fillStyle="#ff0",i.fillRect(t.x-a,t.y,t.width,t.height),i.globalAlpha=1,i.fillStyle="#fff",i.font="20px sans-serif",i.fillText(`Score: ${L}`,20,30),i.fillText(`Level: ${A}`,20,60)}function S(){O(),T(),requestAnimationFrame(S)}S();
