(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const h=document.getElementById("gameCanvas"),e=h.getContext("2d"),ce=.5,Q=5,u=400,de=60,U=1e3/de;let Z=0,ee=0,ie=0,m=localStorage.getItem("speedUnlocked")==="true",D=m?2:1,J=localStorage.getItem("showFpsCounter")!=="false";const T=3200;let x=0;const y=[],z=[],C=[];let d={x:0,y:0,height:80};const l={x:100,y:u-50,width:40,height:50,vx:0,vy:0,onGround:!1,hasDoubleJump:!1,growLevel:0,canDoubleJump:!1},v=[],N=[];function j(){let o=0;const t=[];for(;o<T;){const a=Math.random()<.2?320:160+Math.random()*160;let g;if(Math.random()<.25){const fe=(Math.random()<.5?1:-1)*(20+Math.random()*20);g={x:o,y:u,width:a,height:50,endY:u+fe,isSlope:!0}}else g={x:o,y:u,width:a,height:50};v.push(g),t.push({x:o+a/2,y:u-30}),Math.random()<.5&&y.push({x:o+a/2-10,y:u-30,width:20,height:20,collected:!1,type:"coin"}),Math.random()<.3&&o>0&&z.push({x:o-40,y:u+35,width:40,height:15}),Math.random()<.2&&o>0&&C.push({x:o-60,y:u-100,width:80,height:20,dx:2,range:120,startX:o-60}),o+=a;const p=60+Math.random()*80;o+=p,Math.random()<.5&&o<T-50&&N.push({x:o+10,y:u-40,width:40,height:40})}if(t.length>0){const a=Math.floor(Math.random()*t.length),g=t[a];y.push({x:g.x-10,y:g.y,width:20,height:20,collected:!1,type:"heart"})}if(t.length>1){let a;do a=Math.floor(Math.random()*t.length);while(y.some(p=>p.x===t[a].x-10&&p.y===t[a].y));const g=t[a];y.push({x:g.x-10,y:g.y-30,width:20,height:20,collected:!1,type:"doublejump"})}if(t.length>2){let a;do a=Math.floor(Math.random()*t.length);while(y.some(p=>p.x===t[a].x-10&&p.y===t[a].y)||y.some(p=>p.x===t[a].x-10&&p.y===t[a].y-30));const g=t[a];y.push({x:g.x-10,y:g.y-60,width:20,height:20,collected:!1,type:"grow"})}const s=100;v.some(a=>a.x<=s&&a.x+a.width>=s+40)||v.unshift({x:60,y:u,width:80,height:50});const n=v[v.length-1];let r=n.x+n.width-32,c="isSlope"in n&&n.isSlope?n.endY-d.height:n.y-d.height;d.x=r,d.y=c}j();function $(o,t){return o.x<t.x+t.width&&o.x+o.width>t.x&&o.y<t.y+t.height&&o.y+o.height>t.y}let P=0,W=1,ge=T-100,R=0,L=3,F=!1,A=Number(localStorage.getItem("topScore")||"0"),X=!1,Y=0;function ne(o){o>A&&(A=o,localStorage.setItem("topScore",String(A)))}function ue(){P=0,W=1,L=3,F=!1,v.length=0,N.length=0,y.length=0,z.length=0,C.length=0,j(),q()}function q(){l.x=100,l.y=u-50,l.vx=0,l.vy=0,l.canDoubleJump=!1,V()}function V(){l.growLevel===0?(l.width=40,l.height=50):l.growLevel===1?(l.width=60,l.height=75):l.growLevel===2?(l.width=80,l.height=100):l.growLevel>=3&&(l.width=100,l.height=125)}function te(){if(L--,L<=0){ne(P),F=!0,re();return}l.hasDoubleJump=!1,l.growLevel=0,l.canDoubleJump=!1,V(),q(),R=30}function re(){let o=document.getElementById("restart-btn");o?o&&(o.style.display="block",o.style.top="calc(50% + 120px)",o.style.transform="translateX(-50%)"):(o=document.createElement("button"),o.id="restart-btn",o.textContent="Restart",o.style.position="fixed",o.style.left="50%",o.style.top="calc(50% + 120px)",o.style.transform="translateX(-50%)",o.style.fontSize="2em",o.style.padding="16px 32px",o.style.zIndex="100",o.style.background="#222",o.style.color="#fff",o.style.border="2px solid #0cf",o.style.borderRadius="12px",o.style.cursor="pointer",o.onclick=()=>{o?.remove(),ue()},document.body.appendChild(o))}function ye(){const o=document.getElementById("restart-btn");o&&(o.style.display="none")}function pe(){v.length=0,N.length=0,y.length=0,z.length=0,C.length=0,j(),q(),W++,S?(k=B(),localStorage.setItem("fixedGradientColors",JSON.stringify(k))):b?(G=B(),localStorage.setItem("scrollGradientColors",JSON.stringify(G))):w&&ae(),H(),X=!1,Y=0}function me(){H(),X=!0,Y=120}function xe(o){if(F)return;if(X){Y--,Y<=0&&pe();return}if(R>0){R--;return}l.vx=0,(f.ArrowLeft||f.KeyA)&&(l.vx=-Q*D*o*60),(f.ArrowRight||f.KeyD)&&(l.vx=Q*D*o*60);const t=f.ArrowUp||f.Space||f.KeyW;t&&!le&&(l.onGround?(l.vy=-13,l.onGround=!1,l.hasDoubleJump&&(l.canDoubleJump=!0)):l.hasDoubleJump&&l.canDoubleJump&&(l.vy=-13,l.canDoubleJump=!1)),le=t;const s=f.KeyT;s&&!oe&&(m=!m,localStorage.setItem("speedUnlocked",String(m)),D=m?2:1),oe=s,l.vy+=ce*o*60,l.x+=l.vx,l.y+=l.vy,l.onGround=!1;for(const i of v)if("isSlope"in i&&i.isSlope){if(l.x+l.width>i.x&&l.x<i.x+i.width){const n=(l.x+l.width/2-i.x)/i.width,r=i.y+(i.endY-i.y)*n;l.y+l.height>r&&l.y+l.height<r+i.height&&l.vy>=0&&(l.y=r-l.height,l.vy=0,l.onGround=!0,l.canDoubleJump=l.hasDoubleJump)}}else l.y+l.height>i.y&&l.y+l.height<i.y+i.height&&l.x+l.width>i.x&&l.x<i.x+i.width&&l.vy>=0&&(l.y=i.y-l.height,l.vy=0,l.onGround=!0,l.canDoubleJump=l.hasDoubleJump);for(const i of N)$(l,i)&&(l.y+l.height-l.vy<=i.y?(l.y=i.y-l.height,l.vy=0,l.onGround=!0):l.x+l.width-l.vx<=i.x?l.x=i.x-l.width:l.x-l.vx>=i.x+i.width?l.x=i.x+i.width:l.y-l.vy>=i.y+i.height&&(l.y=i.y+i.height,l.vy=0));for(const i of C)i.x+=i.dx,(i.x>i.startX+i.range||i.x<i.startX)&&(i.dx*=-1);for(const i of C)l.y+l.height>i.y&&l.y+l.height<i.y+i.height&&l.x+l.width>i.x&&l.x<i.x+i.width&&l.vy>=0&&(l.y=i.y-l.height,l.vy=0,l.onGround=!0,l.x+=i.dx);for(const i of y)if(!i.collected&&$(l,i)){if(i.type==="doublejump"&&l.hasDoubleJump||i.type==="grow"&&l.growLevel>=3)continue;i.collected=!0,i.type==="coin"?(P++,ne(P)):i.type==="heart"?L<5&&L++:i.type==="doublejump"?(l.hasDoubleJump=!0,l.canDoubleJump=!1):i.type==="grow"&&(l.growLevel<3&&l.growLevel++,V())}for(const i of z)if($(l,i)){te();break}l.y>h.height+100&&te(),l.x+l.width>=ge&&!X&&me(),x=l.x-h.width/2+l.width/2,x=Math.max(0,Math.min(x,T-h.width)),l.x<0&&(l.x=0),l.x+l.width>T&&(l.x=T-l.width)}let S=localStorage.getItem("fixedGradient")==="true",b=localStorage.getItem("scrollGradient")==="true",k=JSON.parse(localStorage.getItem("fixedGradientColors")||"null")||B(),G=JSON.parse(localStorage.getItem("scrollGradientColors")||"null")||B(),w=localStorage.getItem("imageBg")==="true",M=localStorage.getItem("imageBgUrl")||null,I=null,O=!1;function ae(){fetch("https://pixabay.com/api/?key=51252753-0f1aa9c83b326091b3ad96f88&q=landscape&image_type=photo&orientation=horizontal&safesearch=true&per_page=50").then(s=>s.json()).then(s=>{if(s.hits&&s.hits.length>0){const i=Math.floor(Math.random()*s.hits.length);M=s.hits[i].largeImageURL,M&&(localStorage.setItem("imageBgUrl",M),se())}}).catch(()=>{M=null,O=!1})}function se(){M&&(I=new window.Image,I.crossOrigin="anonymous",I.onload=()=>{O=!0},I.onerror=()=>{O=!1},I.src=M)}M&&se();function B(){function o(){return`hsl(${Math.floor(Math.random()*360)}, 70%, 75%)`}return[o(),o()]}function _(){localStorage.setItem("fixedGradient",String(S)),localStorage.setItem("scrollGradient",String(b)),localStorage.setItem("imageBg",String(w)),localStorage.setItem("fixedGradientColors",JSON.stringify(k)),localStorage.setItem("scrollGradientColors",JSON.stringify(G)),w||(localStorage.removeItem("imageBgUrl"),M=null,I=null,O=!1)}window.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("settings-btn"),t=document.getElementById("settings-modal"),s=document.getElementById("close-settings"),i=document.getElementById("fixed-gradient-toggle"),n=document.getElementById("scroll-gradient-toggle"),r=document.getElementById("image-bg-toggle"),c=document.getElementById("speed-unlock-toggle"),a=document.getElementById("fps-counter-toggle");o&&t&&s&&i&&n&&r&&c&&a&&(o.addEventListener("click",()=>{t.style.display="flex",i.checked=S,n.checked=b,r.checked=w,c.checked=m,a.checked=J}),s.addEventListener("click",()=>{t.style.display="none"}),i.addEventListener("change",()=>{i.checked?(S=!0,b=!1,w=!1,n.checked=!1,r.checked=!1,k=B()):S=!1,_()}),n.addEventListener("change",()=>{n.checked?(b=!0,S=!1,w=!1,i.checked=!1,r.checked=!1,G=B()):b=!1,_()}),r.addEventListener("change",()=>{r.checked?(w=!0,S=!1,b=!1,i.checked=!1,n.checked=!1,ae()):w=!1,_()}),c.addEventListener("change",()=>{m=c.checked,localStorage.setItem("speedUnlocked",String(m)),D=m?2:1}),a.addEventListener("change",()=>{J=a.checked,localStorage.setItem("showFpsCounter",String(J))}))});let E=[],K=0;function H(){E=[];for(let o=0;o<60;o++){const t=Math.random()*Math.PI*2,s=4+Math.random()*3;E.push({x:h.width/2+(Math.random()-.5)*100,y:h.height/2-80+(Math.random()-.5)*40,vx:Math.cos(t)*s,vy:Math.sin(t)*s-2,color:`hsl(${Math.floor(Math.random()*360)}, 80%, 60%)`,size:8+Math.random()*8,life:60+Math.random()*40,angle:Math.random()*Math.PI*2,spin:(Math.random()-.5)*.2})}K=60}function ve(){for(const o of E)o.x+=o.vx,o.y+=o.vy,o.vy+=.15,o.angle+=o.spin,o.life--;E=E.filter(o=>o.life>0&&o.y<h.height+40),K>0&&K--}function we(){for(const o of E)e.save(),e.translate(o.x,o.y),e.rotate(o.angle),e.fillStyle=o.color,e.fillRect(-o.size/2,-o.size/6,o.size,o.size/3),e.restore()}function Se(){if(w&&O&&I){const t=I,s=Math.max(h.width/t.width,h.height/t.height),i=t.width*s,n=t.height*s;let r=-x%i;r>0&&(r-=i);for(let c=r;c<h.width;c+=i)e.drawImage(t,c,0,i,n)}else if(S){const t=e.createLinearGradient(0,0,0,h.height);t.addColorStop(0,k[0]),t.addColorStop(1,k[1]),e.fillStyle=t,e.fillRect(0,0,h.width,h.height)}else if(b){const t=e.createLinearGradient(-x,0,T-x,h.height);t.addColorStop(0,G[0]),t.addColorStop(1,G[1]),e.fillStyle=t,e.fillRect(0,0,h.width,h.height)}else e.fillStyle="#87ceeb",e.fillRect(0,0,h.width,h.height);e.save(),e.translate(-x,0),e.fillStyle="#654321";for(const t of v)"isSlope"in t&&t.isSlope?(e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(t.x+t.width,t.endY),e.lineTo(t.x+t.width,t.endY+t.height),e.lineTo(t.x,t.y+t.height),e.closePath(),e.fill()):e.fillRect(t.x,t.y,t.width,t.height);e.fillStyle="#888";for(const t of C)e.fillRect(t.x,t.y,t.width,t.height);e.fillStyle="#b5651d";for(const t of N)e.fillRect(t.x,t.y,t.width,t.height);for(const t of y)t.collected||(t.type==="coin"?(e.fillStyle="#0cf",e.beginPath(),e.arc(t.x+t.width/2,t.y+t.height/2,10,0,2*Math.PI),e.fill()):t.type==="heart"?(e.save(),e.translate(t.x+t.width/2,t.y+t.height/2),e.scale(1.2,1.2),e.beginPath(),e.moveTo(0,6),e.bezierCurveTo(0,0,-10,0,-10,6),e.bezierCurveTo(-10,12,0,16,0,20),e.bezierCurveTo(0,16,10,12,10,6),e.bezierCurveTo(10,0,0,0,0,6),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore()):t.type==="doublejump"?(e.save(),e.translate(t.x+t.width/2,t.y+t.height/2),e.rotate(-.3),e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(10,-10,0,-20),e.quadraticCurveTo(-8,-10,0,0),e.closePath(),e.fillStyle="#fff",e.fill(),e.strokeStyle="#0cf",e.lineWidth=2,e.stroke(),e.restore()):t.type==="grow"&&(e.save(),e.translate(t.x+t.width/2,t.y+t.height/2),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.lineTo(10,10),e.arc(0,10,10,0,Math.PI,!0),e.closePath(),e.fillStyle="#fff",e.fill(),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore()));e.fillStyle="#e33";for(const t of z)e.beginPath(),e.moveTo(t.x,t.y+t.height),e.lineTo(t.x+t.width/2,t.y),e.lineTo(t.x+t.width,t.y+t.height),e.closePath(),e.fill();if(e.restore(),R>0&&Math.floor(R/5)%2===0?e.globalAlpha=.3:e.globalAlpha=1,e.fillStyle="#ff0",e.fillRect(l.x-x,l.y,l.width,l.height),e.globalAlpha=1,e.save(),e.fillStyle="#fff",e.font="20px sans-serif",e.textAlign="left",e.fillText(`Score: ${P}`,20,30),e.fillText(`Top Score: ${A}`,20,60),e.fillText(`Level: ${W}`,20,90),J&&e.fillText(`FPS: ${ie}`,20,120),m){e.fillStyle="#0cf";const t=J?150:120;e.fillText(`Speed: ${D}x`,20,t)}for(let t=0;t<L;t++)e.save(),e.translate(20+t*28,120),e.scale(1.2,1.2),e.beginPath(),e.moveTo(0,6),e.bezierCurveTo(0,0,-10,0,-10,6),e.bezierCurveTo(-10,12,0,16,0,20),e.bezierCurveTo(0,16,10,12,10,6),e.bezierCurveTo(10,0,0,0,0,6),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore();let o=20+L*28+20;l.hasDoubleJump&&(e.save(),e.translate(o,120),e.rotate(-.3),e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(10,-10,0,-20),e.quadraticCurveTo(-8,-10,0,0),e.closePath(),e.fillStyle="#fff",e.fill(),e.strokeStyle="#0cf",e.lineWidth=2,e.stroke(),e.restore(),o+=36);for(let t=0;t<l.growLevel;t++)e.save(),e.translate(o,120),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.lineTo(10,10),e.arc(0,10,10,0,Math.PI,!0),e.closePath(),e.fillStyle="#fff",e.fill(),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore(),o+=36;e.restore(),F?(e.save(),e.font="bold 48px sans-serif",e.fillStyle="#e33",e.textAlign="center",e.fillText("Game Over",h.width/2,h.height/2-60),e.font="32px sans-serif",e.fillStyle="#fff",e.fillText(`Score: ${P}`,h.width/2,h.height/2-10),e.fillText(`Top Score: ${A}`,h.width/2,h.height/2+40),P>Number(localStorage.getItem("topScore")||"0")&&(e.font="bold 28px sans-serif",e.fillStyle="#0cf",e.fillText("You beat your own top score!",h.width/2,h.height/2+90),K===0&&H()),e.restore(),re()):ye(),e.save(),e.translate(-x,0),e.fillStyle="#fff",e.fillRect(d.x,d.y,8,d.height),e.beginPath(),e.moveTo(d.x+8,d.y),e.lineTo(d.x+8+32,d.y+16),e.lineTo(d.x+8,d.y+32),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore(),we()}function he(){const o=performance.now(),t=o-Z;t>=U&&(ee++,ee%60===0&&(ie=Math.round(1e3/U)),xe(U/1e3),ve(),Se(),Z=o-t%U),requestAnimationFrame(he)}const f={};let le=!1,oe=!1;window.addEventListener("keydown",o=>{f[o.code]=!0});window.addEventListener("keyup",o=>{f[o.code]=!1});function be(){if(!/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent))return;const t=document.getElementById("btn-left"),s=document.getElementById("btn-right"),i=document.getElementById("btn-jump");t&&s&&i&&(t.addEventListener("touchstart",n=>{n.preventDefault(),f.ArrowLeft=!0}),t.addEventListener("touchend",n=>{n.preventDefault(),f.ArrowLeft=!1}),s.addEventListener("touchstart",n=>{n.preventDefault(),f.ArrowRight=!0}),s.addEventListener("touchend",n=>{n.preventDefault(),f.ArrowRight=!1}),i.addEventListener("touchstart",n=>{n.preventDefault(),f.Space=!0}),i.addEventListener("touchend",n=>{n.preventDefault(),f.Space=!1}))}be();he();
