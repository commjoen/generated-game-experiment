(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const P of a.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&s(P)}).observe(document,{childList:!0,subtree:!0});function n(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=n(l);fetch(l.href,a)}})();const r=document.getElementById("gameCanvas"),t=r.getContext("2d"),te=.5,W=4,d=400,w=3200;let g=0;const M=[],R=[],L=[];let f={x:0,y:0,height:80};const o={x:100,y:d-50,width:40,height:50,vx:0,vy:0,onGround:!1},y=[],O=[];function J(){let e=0;const i=[];for(;e<w;){const c=Math.random()<.2?320:160+Math.random()*160;let b;if(Math.random()<.25){const ee=(Math.random()<.5?1:-1)*(20+Math.random()*20);b={x:e,y:d,width:c,height:50,endY:d+ee,isSlope:!0}}else b={x:e,y:d,width:c,height:50};y.push(b),i.push({x:e+c/2,y:d-30}),Math.random()<.5&&M.push({x:e+c/2-10,y:d-30,width:20,height:20,collected:!1,type:"coin"}),Math.random()<.3&&e>0&&R.push({x:e-40,y:d+35,width:40,height:15}),Math.random()<.2&&e>0&&L.push({x:e-60,y:d-100,width:80,height:20,dx:2,range:120,startX:e-60}),e+=c;const Z=60+Math.random()*80;e+=Z,Math.random()<.5&&e<w-50&&O.push({x:e+10,y:d-40,width:40,height:40})}if(i.length>0){const c=Math.floor(Math.random()*i.length),b=i[c];M.push({x:b.x-10,y:b.y,width:20,height:20,collected:!1,type:"heart"})}const n=100;y.some(c=>c.x<=n&&c.x+c.width>=n+40)||y.unshift({x:60,y:d,width:80,height:50});const l=y[y.length-1];let a=l.x+l.width-32,P="isSlope"in l&&l.isSlope?l.endY-f.height:l.y-f.height;f.x=a,f.y=P}J();function Y(e,i){return e.x<i.x+i.width&&e.x+e.width>i.x&&e.y<i.y+i.height&&e.y+e.height>i.y}let S=0,U=1,oe=w-100,k=0,T=3,X=!1,B=Number(localStorage.getItem("topScore")||"0"),z=!1,N=0;function q(e){e>B&&(B=e,localStorage.setItem("topScore",String(B)))}function le(){S=0,U=1,T=3,X=!1,y.length=0,O.length=0,M.length=0,R.length=0,L.length=0,J(),_()}function _(){o.x=100,o.y=d-50,o.vx=0,o.vy=0}function j(){if(T--,T<=0){q(S),X=!0,F();return}_(),k=30}function F(){let e=document.getElementById("restart-btn");e?e&&(e.style.display="block",e.style.top="calc(50% + 120px)",e.style.transform="translateX(-50%)"):(e=document.createElement("button"),e.id="restart-btn",e.textContent="Restart",e.style.position="fixed",e.style.left="50%",e.style.top="calc(50% + 120px)",e.style.transform="translateX(-50%)",e.style.fontSize="2em",e.style.padding="16px 32px",e.style.zIndex="100",e.style.background="#222",e.style.color="#fff",e.style.border="2px solid #0cf",e.style.borderRadius="12px",e.style.cursor="pointer",e.onclick=()=>{e?.remove(),le()},document.body.appendChild(e))}function ie(){const e=document.getElementById("restart-btn");e&&(e.style.display="none")}function ne(){y.length=0,O.length=0,M.length=0,R.length=0,L.length=0,J(),_(),U++,m?(E=G(),localStorage.setItem("fixedGradientColors",JSON.stringify(E))):x?(C=G(),localStorage.setItem("scrollGradientColors",JSON.stringify(C))):u&&V(),K(),z=!1,N=0}function re(){K(),z=!0,N=120}function ae(){if(!X){if(z){N--,N<=0&&ne();return}if(k>0){k--;return}o.vx=0,(h.ArrowLeft||h.KeyA)&&(o.vx=-W),(h.ArrowRight||h.KeyD)&&(o.vx=W),(h.ArrowUp||h.Space||h.KeyW)&&o.onGround&&(o.vy=-12,o.onGround=!1),o.vy+=te,o.x+=o.vx,o.y+=o.vy,o.onGround=!1;for(const e of y)if("isSlope"in e&&e.isSlope){if(o.x+o.width>e.x&&o.x<e.x+e.width){const i=(o.x+o.width/2-e.x)/e.width,n=e.y+(e.endY-e.y)*i;o.y+o.height>n&&o.y+o.height<n+e.height&&o.vy>=0&&(o.y=n-o.height,o.vy=0,o.onGround=!0)}}else o.y+o.height>e.y&&o.y+o.height<e.y+e.height&&o.x+o.width>e.x&&o.x<e.x+e.width&&o.vy>=0&&(o.y=e.y-o.height,o.vy=0,o.onGround=!0);for(const e of O)Y(o,e)&&(o.y+o.height-o.vy<=e.y?(o.y=e.y-o.height,o.vy=0,o.onGround=!0):o.x+o.width-o.vx<=e.x?o.x=e.x-o.width:o.x-o.vx>=e.x+e.width?o.x=e.x+e.width:o.y-o.vy>=e.y+e.height&&(o.y=e.y+e.height,o.vy=0));for(const e of L)e.x+=e.dx,(e.x>e.startX+e.range||e.x<e.startX)&&(e.dx*=-1);for(const e of L)o.y+o.height>e.y&&o.y+o.height<e.y+e.height&&o.x+o.width>e.x&&o.x<e.x+e.width&&o.vy>=0&&(o.y=e.y-o.height,o.vy=0,o.onGround=!0,o.x+=e.dx);for(const e of M)!e.collected&&Y(o,e)&&(e.collected=!0,e.type==="coin"?(S++,q(S)):e.type==="heart"&&T<5&&T++);for(const e of R)if(Y(o,e)){j();break}o.y>r.height+100&&j(),o.x+o.width>=oe&&!z&&re(),g=o.x-r.width/2+o.width/2,g=Math.max(0,Math.min(g,w-r.width)),o.x<0&&(o.x=0),o.x+o.width>w&&(o.x=w-o.width)}}let m=localStorage.getItem("fixedGradient")==="true",x=localStorage.getItem("scrollGradient")==="true",E=JSON.parse(localStorage.getItem("fixedGradientColors")||"null")||G(),C=JSON.parse(localStorage.getItem("scrollGradientColors")||"null")||G(),u=localStorage.getItem("imageBg")==="true",v=localStorage.getItem("imageBgUrl")||null,p=null,A=!1;function V(){fetch("https://pixabay.com/api/?key=51252753-0f1aa9c83b326091b3ad96f88&q=landscape&image_type=photo&orientation=horizontal&safesearch=true&per_page=50").then(n=>n.json()).then(n=>{if(n.hits&&n.hits.length>0){const s=Math.floor(Math.random()*n.hits.length);v=n.hits[s].largeImageURL,v&&(localStorage.setItem("imageBgUrl",v),H())}}).catch(()=>{v=null,A=!1})}function H(){v&&(p=new window.Image,p.crossOrigin="anonymous",p.onload=()=>{A=!0},p.onerror=()=>{A=!1},p.src=v)}v&&H();function G(){function e(){return`hsl(${Math.floor(Math.random()*360)}, 70%, 75%)`}return[e(),e()]}function $(){localStorage.setItem("fixedGradient",String(m)),localStorage.setItem("scrollGradient",String(x)),localStorage.setItem("imageBg",String(u)),localStorage.setItem("fixedGradientColors",JSON.stringify(E)),localStorage.setItem("scrollGradientColors",JSON.stringify(C)),u||(localStorage.removeItem("imageBgUrl"),v=null,p=null,A=!1)}window.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("settings-btn"),i=document.getElementById("settings-modal"),n=document.getElementById("close-settings"),s=document.getElementById("fixed-gradient-toggle"),l=document.getElementById("scroll-gradient-toggle"),a=document.getElementById("image-bg-toggle");e&&i&&n&&s&&l&&a&&(e.addEventListener("click",()=>{i.style.display="flex",s.checked=m,l.checked=x,a.checked=u}),n.addEventListener("click",()=>{i.style.display="none"}),s.addEventListener("change",()=>{s.checked?(m=!0,x=!1,u=!1,l.checked=!1,a.checked=!1,E=G()):m=!1,$()}),l.addEventListener("change",()=>{l.checked?(x=!0,m=!1,u=!1,s.checked=!1,a.checked=!1,C=G()):x=!1,$()}),a.addEventListener("change",()=>{a.checked?(u=!0,m=!1,x=!1,s.checked=!1,l.checked=!1,V()):u=!1,$()}))});let I=[],D=0;function K(){I=[];for(let e=0;e<60;e++){const i=Math.random()*Math.PI*2,n=4+Math.random()*3;I.push({x:r.width/2+(Math.random()-.5)*100,y:r.height/2-80+(Math.random()-.5)*40,vx:Math.cos(i)*n,vy:Math.sin(i)*n-2,color:`hsl(${Math.floor(Math.random()*360)}, 80%, 60%)`,size:8+Math.random()*8,life:60+Math.random()*40,angle:Math.random()*Math.PI*2,spin:(Math.random()-.5)*.2})}D=60}function se(){for(const e of I)e.x+=e.vx,e.y+=e.vy,e.vy+=.15,e.angle+=e.spin,e.life--;I=I.filter(e=>e.life>0&&e.y<r.height+40),D>0&&D--}function he(){for(const e of I)t.save(),t.translate(e.x,e.y),t.rotate(e.angle),t.fillStyle=e.color,t.fillRect(-e.size/2,-e.size/6,e.size,e.size/3),t.restore()}function fe(){if(u&&A&&p){const e=p,i=Math.max(r.width/e.width,r.height/e.height),n=e.width*i,s=e.height*i;let l=-g%n;l>0&&(l-=n);for(let a=l;a<r.width;a+=n)t.drawImage(e,a,0,n,s)}else if(m){const e=t.createLinearGradient(0,0,0,r.height);e.addColorStop(0,E[0]),e.addColorStop(1,E[1]),t.fillStyle=e,t.fillRect(0,0,r.width,r.height)}else if(x){const e=t.createLinearGradient(-g,0,w-g,r.height);e.addColorStop(0,C[0]),e.addColorStop(1,C[1]),t.fillStyle=e,t.fillRect(0,0,r.width,r.height)}else t.fillStyle="#87ceeb",t.fillRect(0,0,r.width,r.height);t.save(),t.translate(-g,0),t.fillStyle="#654321";for(const e of y)"isSlope"in e&&e.isSlope?(t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(e.x+e.width,e.endY),t.lineTo(e.x+e.width,e.endY+e.height),t.lineTo(e.x,e.y+e.height),t.closePath(),t.fill()):t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#888";for(const e of L)t.fillRect(e.x,e.y,e.width,e.height);t.fillStyle="#b5651d";for(const e of O)t.fillRect(e.x,e.y,e.width,e.height);for(const e of M)e.collected||(e.type==="coin"?(t.fillStyle="#0cf",t.beginPath(),t.arc(e.x+e.width/2,e.y+e.height/2,10,0,2*Math.PI),t.fill()):e.type==="heart"&&(t.save(),t.translate(e.x+e.width/2,e.y+e.height/2),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore()));t.fillStyle="#e33";for(const e of R)t.beginPath(),t.moveTo(e.x,e.y+e.height),t.lineTo(e.x+e.width/2,e.y),t.lineTo(e.x+e.width,e.y+e.height),t.closePath(),t.fill();t.restore(),k>0&&Math.floor(k/5)%2===0?t.globalAlpha=.3:t.globalAlpha=1,t.fillStyle="#ff0",t.fillRect(o.x-g,o.y,o.width,o.height),t.globalAlpha=1,t.save(),t.fillStyle="#fff",t.font="20px sans-serif",t.textAlign="left",t.fillText(`Score: ${S}`,20,30),t.fillText(`Top Score: ${B}`,20,60),t.fillText(`Level: ${U}`,20,90);for(let e=0;e<T;e++)t.save(),t.translate(20+e*28,120),t.scale(1.2,1.2),t.beginPath(),t.moveTo(0,6),t.bezierCurveTo(0,0,-10,0,-10,6),t.bezierCurveTo(-10,12,0,16,0,20),t.bezierCurveTo(0,16,10,12,10,6),t.bezierCurveTo(10,0,0,0,0,6),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore();t.restore(),X?(t.save(),t.font="bold 48px sans-serif",t.fillStyle="#e33",t.textAlign="center",t.fillText("Game Over",r.width/2,r.height/2-60),t.font="32px sans-serif",t.fillStyle="#fff",t.fillText(`Score: ${S}`,r.width/2,r.height/2-10),t.fillText(`Top Score: ${B}`,r.width/2,r.height/2+40),S>Number(localStorage.getItem("topScore")||"0")&&(t.font="bold 28px sans-serif",t.fillStyle="#0cf",t.fillText("You beat your own top score!",r.width/2,r.height/2+90),D===0&&K()),t.restore(),F()):ie(),t.save(),t.translate(-g,0),t.fillStyle="#fff",t.fillRect(f.x,f.y,8,f.height),t.beginPath(),t.moveTo(f.x+8,f.y),t.lineTo(f.x+8+32,f.y+16),t.lineTo(f.x+8,f.y+32),t.closePath(),t.fillStyle="#e33",t.fill(),t.restore(),he()}function Q(){ae(),se(),fe(),requestAnimationFrame(Q)}const h={};window.addEventListener("keydown",e=>{h[e.code]=!0});window.addEventListener("keyup",e=>{h[e.code]=!1});function ce(){if(!/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent))return;const i=document.getElementById("btn-left"),n=document.getElementById("btn-right"),s=document.getElementById("btn-jump");i&&n&&s&&(i.addEventListener("touchstart",l=>{l.preventDefault(),h.ArrowLeft=!0}),i.addEventListener("touchend",l=>{l.preventDefault(),h.ArrowLeft=!1}),n.addEventListener("touchstart",l=>{l.preventDefault(),h.ArrowRight=!0}),n.addEventListener("touchend",l=>{l.preventDefault(),h.ArrowRight=!1}),s.addEventListener("touchstart",l=>{l.preventDefault(),h.Space=!0}),s.addEventListener("touchend",l=>{l.preventDefault(),h.Space=!1}))}ce();Q();
