(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function h(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=h(n);fetch(n.href,a)}})();const r=document.getElementById("gameCanvas"),e=r.getContext("2d"),fe=.5,Q=5,u=400,ce=60;let Z=0,ee=0,oe=0,m=localStorage.getItem("speedUnlocked")==="true",J=m?2:1,R=localStorage.getItem("showFpsCounter")!=="false";const P=3200;let x=0;const y=[],N=[],E=[];let d={x:0,y:0,height:80};const l={x:100,y:u-50,width:40,height:50,vx:0,vy:0,onGround:!1,hasDoubleJump:!1,growLevel:0,canDoubleJump:!1},w=[],U=[];function W(){let o=0;const t=[];for(;o<P;){const s=Math.random()<.2?320:160+Math.random()*160;let g;if(Math.random()<.25){const he=(Math.random()<.5?1:-1)*(20+Math.random()*20);g={x:o,y:u,width:s,height:50,endY:u+he,isSlope:!0}}else g={x:o,y:u,width:s,height:50};w.push(g),t.push({x:o+s/2,y:u-30}),Math.random()<.5&&y.push({x:o+s/2-10,y:u-30,width:20,height:20,collected:!1,type:"coin"}),Math.random()<.3&&o>0&&N.push({x:o-40,y:u+35,width:40,height:15}),Math.random()<.2&&o>0&&E.push({x:o-60,y:u-100,width:80,height:20,dx:2,range:120,startX:o-60}),o+=s;const p=60+Math.random()*80;o+=p,Math.random()<.5&&o<P-50&&U.push({x:o+10,y:u-40,width:40,height:40})}if(t.length>0){const s=Math.floor(Math.random()*t.length),g=t[s];y.push({x:g.x-10,y:g.y,width:20,height:20,collected:!1,type:"heart"})}if(t.length>1){let s;do s=Math.floor(Math.random()*t.length);while(y.some(p=>p.x===t[s].x-10&&p.y===t[s].y));const g=t[s];y.push({x:g.x-10,y:g.y-30,width:20,height:20,collected:!1,type:"doublejump"})}if(t.length>2){let s;do s=Math.floor(Math.random()*t.length);while(y.some(p=>p.x===t[s].x-10&&p.y===t[s].y)||y.some(p=>p.x===t[s].x-10&&p.y===t[s].y-30));const g=t[s];y.push({x:g.x-10,y:g.y-60,width:20,height:20,collected:!1,type:"grow"})}const h=100;w.some(s=>s.x<=h&&s.x+s.width>=h+40)||w.unshift({x:60,y:u,width:80,height:50});const n=w[w.length-1];let a=n.x+n.width-32,c="isSlope"in n&&n.isSlope?n.endY-d.height:n.y-d.height;d.x=a,d.y=c}W();function j(o,t){return o.x<t.x+t.width&&o.x+o.width>t.x&&o.y<t.y+t.height&&o.y+o.height>t.y}let T=0,_=1,de=P-100,O=0,L=3,$=!1,A=Number(localStorage.getItem("topScore")||"0"),X=!1,Y=0;function ie(o){o>A&&(A=o,localStorage.setItem("topScore",String(A)))}function ge(){T=0,_=1,L=3,$=!1,w.length=0,U.length=0,y.length=0,N.length=0,E.length=0,W(),q()}function q(){l.x=100,l.y=u-175,l.vx=0,l.vy=0,l.canDoubleJump=!1,V()}function V(){l.growLevel===0?(l.width=40,l.height=50):l.growLevel===1?(l.width=60,l.height=75):l.growLevel===2?(l.width=80,l.height=100):l.growLevel>=3&&(l.width=100,l.height=125)}function te(){if(L--,L<=0){ie(T),$=!0,ne();return}l.hasDoubleJump=!1,l.growLevel=0,l.canDoubleJump=!1,V(),q(),O=30}function ne(){let o=document.getElementById("restart-btn");o?o&&(o.style.display="block",o.style.top="calc(50% + 120px)",o.style.transform="translateX(-50%)"):(o=document.createElement("button"),o.id="restart-btn",o.textContent="Restart",o.style.position="fixed",o.style.left="50%",o.style.top="calc(50% + 120px)",o.style.transform="translateX(-50%)",o.style.fontSize="2em",o.style.padding="16px 32px",o.style.zIndex="100",o.style.background="#222",o.style.color="#fff",o.style.border="2px solid #0cf",o.style.borderRadius="12px",o.style.cursor="pointer",o.onclick=()=>{o?.remove(),ge()},document.body.appendChild(o))}function ue(){const o=document.getElementById("restart-btn");o&&(o.style.display="none")}function ye(){w.length=0,U.length=0,y.length=0,N.length=0,E.length=0,W(),q(),_++,S?(k=B(),localStorage.setItem("fixedGradientColors",JSON.stringify(k))):b?(G=B(),localStorage.setItem("scrollGradientColors",JSON.stringify(G))):v&&re(),H(),X=!1,Y=0}function pe(){H(),X=!0,Y=120}function me(o){if($)return;if(X){Y--,Y<=0&&ye();return}if(O>0){O--;return}l.vx=0,(f.ArrowLeft||f.KeyA)&&(l.vx=-Q*J*o*60),(f.ArrowRight||f.KeyD)&&(l.vx=Q*J*o*60);const t=f.ArrowUp||f.Space||f.KeyW;D>0&&D--,t&&D===0&&(l.onGround?(l.vy=-13,l.onGround=!1,l.hasDoubleJump&&(l.canDoubleJump=!0),D=8):l.hasDoubleJump&&l.canDoubleJump&&(l.vy=-13,l.canDoubleJump=!1,D=8));const h=f.KeyT;h&&!le&&(m=!m,localStorage.setItem("speedUnlocked",String(m)),J=m?2:1),le=h,l.vy+=fe*o*60,l.x+=l.vx,l.y+=l.vy,l.onGround=!1;for(const i of w)if("isSlope"in i&&i.isSlope){if(l.x+l.width>i.x&&l.x<i.x+i.width){const n=(l.x+l.width/2-i.x)/i.width,a=i.y+(i.endY-i.y)*n;l.y+l.height>a&&l.y+l.height<a+i.height&&l.vy>=0&&(l.y=a-l.height,l.vy=0,l.onGround=!0,l.canDoubleJump=l.hasDoubleJump)}}else l.y+l.height>i.y&&l.y+l.height<i.y+i.height&&l.x+l.width>i.x&&l.x<i.x+i.width&&l.vy>=0&&(l.y=i.y-l.height,l.vy=0,l.onGround=!0,l.canDoubleJump=l.hasDoubleJump);for(const i of U)j(l,i)&&(l.y+l.height-l.vy<=i.y?(l.y=i.y-l.height,l.vy=0,l.onGround=!0):l.x+l.width-l.vx<=i.x?l.x=i.x-l.width:l.x-l.vx>=i.x+i.width?l.x=i.x+i.width:l.y-l.vy>=i.y+i.height&&(l.y=i.y+i.height,l.vy=0));for(const i of E)i.x+=i.dx,(i.x>i.startX+i.range||i.x<i.startX)&&(i.dx*=-1);for(const i of E)l.y+l.height>i.y&&l.y+l.height<i.y+i.height&&l.x+l.width>i.x&&l.x<i.x+i.width&&l.vy>=0&&(l.y=i.y-l.height,l.vy=0,l.onGround=!0,l.x+=i.dx);for(const i of y)if(!i.collected&&j(l,i)){if(i.type==="doublejump"&&l.hasDoubleJump||i.type==="grow"&&l.growLevel>=3)continue;i.collected=!0,i.type==="coin"?(T++,ie(T)):i.type==="heart"?L<5&&L++:i.type==="doublejump"?(l.hasDoubleJump=!0,l.canDoubleJump=!1):i.type==="grow"&&(l.growLevel<3&&l.growLevel++,V())}for(const i of N)if(j(l,i)){te();break}l.y>r.height+100&&te(),l.x+l.width>=de&&!X&&pe(),x=l.x-r.width/2+l.width/2,x=Math.max(0,Math.min(x,P-r.width)),l.x<0&&(l.x=0),l.x+l.width>P&&(l.x=P-l.width)}let S=localStorage.getItem("fixedGradient")==="true",b=localStorage.getItem("scrollGradient")==="true",k=JSON.parse(localStorage.getItem("fixedGradientColors")||"null")||B(),G=JSON.parse(localStorage.getItem("scrollGradientColors")||"null")||B(),v=localStorage.getItem("imageBg")==="true",M=localStorage.getItem("imageBgUrl")||null,I=null,z=!1;function re(){fetch("https://pixabay.com/api/?key=51252753-0f1aa9c83b326091b3ad96f88&q=landscape&image_type=photo&orientation=horizontal&safesearch=true&per_page=50").then(h=>h.json()).then(h=>{if(h.hits&&h.hits.length>0){const i=Math.floor(Math.random()*h.hits.length);M=h.hits[i].largeImageURL,M&&(localStorage.setItem("imageBgUrl",M),ae())}}).catch(()=>{M=null,z=!1})}function ae(){M&&(I=new window.Image,I.crossOrigin="anonymous",I.onload=()=>{z=!0},I.onerror=()=>{z=!1},I.src=M)}M&&ae();function B(){function o(){return`hsl(${Math.floor(Math.random()*360)}, 70%, 75%)`}return[o(),o()]}function F(){localStorage.setItem("fixedGradient",String(S)),localStorage.setItem("scrollGradient",String(b)),localStorage.setItem("imageBg",String(v)),localStorage.setItem("fixedGradientColors",JSON.stringify(k)),localStorage.setItem("scrollGradientColors",JSON.stringify(G)),v||(localStorage.removeItem("imageBgUrl"),M=null,I=null,z=!1)}window.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("settings-btn"),t=document.getElementById("settings-modal"),h=document.getElementById("close-settings"),i=document.getElementById("fixed-gradient-toggle"),n=document.getElementById("scroll-gradient-toggle"),a=document.getElementById("image-bg-toggle"),c=document.getElementById("speed-unlock-toggle"),s=document.getElementById("fps-counter-toggle");o&&t&&h&&i&&n&&a&&c&&s&&(o.addEventListener("click",()=>{t.style.display="flex",i.checked=S,n.checked=b,a.checked=v,c.checked=m,s.checked=R}),h.addEventListener("click",()=>{t.style.display="none"}),i.addEventListener("change",()=>{i.checked?(S=!0,b=!1,v=!1,n.checked=!1,a.checked=!1,k=B()):S=!1,F()}),n.addEventListener("change",()=>{n.checked?(b=!0,S=!1,v=!1,i.checked=!1,a.checked=!1,G=B()):b=!1,F()}),a.addEventListener("change",()=>{a.checked?(v=!0,S=!1,b=!1,i.checked=!1,n.checked=!1,re()):v=!1,F()}),c.addEventListener("change",()=>{m=c.checked,localStorage.setItem("speedUnlocked",String(m)),J=m?2:1}),s.addEventListener("change",()=>{R=s.checked,localStorage.setItem("showFpsCounter",String(R))}))});let C=[],K=0;function H(){C=[];for(let o=0;o<60;o++){const t=Math.random()*Math.PI*2,h=4+Math.random()*3;C.push({x:r.width/2+(Math.random()-.5)*100,y:r.height/2-80+(Math.random()-.5)*40,vx:Math.cos(t)*h,vy:Math.sin(t)*h-2,color:`hsl(${Math.floor(Math.random()*360)}, 80%, 60%)`,size:8+Math.random()*8,life:60+Math.random()*40,angle:Math.random()*Math.PI*2,spin:(Math.random()-.5)*.2})}K=60}function xe(){for(const o of C)o.x+=o.vx,o.y+=o.vy,o.vy+=.15,o.angle+=o.spin,o.life--;C=C.filter(o=>o.life>0&&o.y<r.height+40),K>0&&K--}function we(){for(const o of C)e.save(),e.translate(o.x,o.y),e.rotate(o.angle),e.fillStyle=o.color,e.fillRect(-o.size/2,-o.size/6,o.size,o.size/3),e.restore()}function ve(){if(v&&z&&I){const t=I,h=Math.max(r.width/t.width,r.height/t.height),i=t.width*h,n=t.height*h;let a=-x%i;a>0&&(a-=i);for(let c=a;c<r.width;c+=i)e.drawImage(t,c,0,i,n)}else if(S){const t=e.createLinearGradient(0,0,0,r.height);t.addColorStop(0,k[0]),t.addColorStop(1,k[1]),e.fillStyle=t,e.fillRect(0,0,r.width,r.height)}else if(b){const t=e.createLinearGradient(-x,0,P-x,r.height);t.addColorStop(0,G[0]),t.addColorStop(1,G[1]),e.fillStyle=t,e.fillRect(0,0,r.width,r.height)}else e.fillStyle="#87ceeb",e.fillRect(0,0,r.width,r.height);e.save(),e.translate(-x,0),e.fillStyle="#654321";for(const t of w)"isSlope"in t&&t.isSlope?(e.beginPath(),e.moveTo(t.x,t.y),e.lineTo(t.x+t.width,t.endY),e.lineTo(t.x+t.width,t.endY+t.height),e.lineTo(t.x,t.y+t.height),e.closePath(),e.fill()):e.fillRect(t.x,t.y,t.width,t.height);e.fillStyle="#888";for(const t of E)e.fillRect(t.x,t.y,t.width,t.height);e.fillStyle="#b5651d";for(const t of U)e.fillRect(t.x,t.y,t.width,t.height);for(const t of y)t.collected||(t.type==="coin"?(e.fillStyle="#0cf",e.beginPath(),e.arc(t.x+t.width/2,t.y+t.height/2,10,0,2*Math.PI),e.fill()):t.type==="heart"?(e.save(),e.translate(t.x+t.width/2,t.y+t.height/2),e.scale(1.2,1.2),e.beginPath(),e.moveTo(0,6),e.bezierCurveTo(0,0,-10,0,-10,6),e.bezierCurveTo(-10,12,0,16,0,20),e.bezierCurveTo(0,16,10,12,10,6),e.bezierCurveTo(10,0,0,0,0,6),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore()):t.type==="doublejump"?(e.save(),e.translate(t.x+t.width/2,t.y+t.height/2),e.rotate(-.3),e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(10,-10,0,-20),e.quadraticCurveTo(-8,-10,0,0),e.closePath(),e.fillStyle="#fff",e.fill(),e.strokeStyle="#0cf",e.lineWidth=2,e.stroke(),e.restore()):t.type==="grow"&&(e.save(),e.translate(t.x+t.width/2,t.y+t.height/2),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.lineTo(10,10),e.arc(0,10,10,0,Math.PI,!0),e.closePath(),e.fillStyle="#fff",e.fill(),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore()));e.fillStyle="#e33";for(const t of N)e.beginPath(),e.moveTo(t.x,t.y+t.height),e.lineTo(t.x+t.width/2,t.y),e.lineTo(t.x+t.width,t.y+t.height),e.closePath(),e.fill();if(e.restore(),O>0&&Math.floor(O/5)%2===0?e.globalAlpha=.3:e.globalAlpha=1,e.fillStyle="#ff0",e.fillRect(l.x-x,l.y,l.width,l.height),e.globalAlpha=1,e.save(),e.fillStyle="#fff",e.font="20px sans-serif",e.textAlign="left",e.fillText(`Score: ${T}`,20,30),e.fillText(`Top Score: ${A}`,20,60),e.fillText(`Level: ${_}`,20,90),R&&e.fillText(`FPS: ${oe}`,20,120),m){e.fillStyle="#0cf";const t=R?150:120;e.fillText(`Speed: ${J}x`,20,t)}for(let t=0;t<L;t++)e.save(),e.translate(20+t*28,120),e.scale(1.2,1.2),e.beginPath(),e.moveTo(0,6),e.bezierCurveTo(0,0,-10,0,-10,6),e.bezierCurveTo(-10,12,0,16,0,20),e.bezierCurveTo(0,16,10,12,10,6),e.bezierCurveTo(10,0,0,0,0,6),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore();let o=20+L*28+20;l.hasDoubleJump&&(e.save(),e.translate(o,120),e.rotate(-.3),e.beginPath(),e.moveTo(0,0),e.quadraticCurveTo(10,-10,0,-20),e.quadraticCurveTo(-8,-10,0,0),e.closePath(),e.fillStyle="#fff",e.fill(),e.strokeStyle="#0cf",e.lineWidth=2,e.stroke(),e.restore(),o+=36);for(let t=0;t<l.growLevel;t++)e.save(),e.translate(o,120),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.lineTo(10,10),e.arc(0,10,10,0,Math.PI,!0),e.closePath(),e.fillStyle="#fff",e.fill(),e.beginPath(),e.arc(0,0,10,Math.PI,2*Math.PI),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore(),o+=36;e.restore(),$?(e.save(),e.fillStyle="rgba(0, 0, 0, 0.7)",e.fillRect(r.width/2-200,r.height/2-100,400,200),e.strokeStyle="#444",e.lineWidth=2,e.strokeRect(r.width/2-200,r.height/2-100,400,200),e.font="bold 48px sans-serif",e.fillStyle="#e33",e.textAlign="center",e.fillText("Game Over",r.width/2,r.height/2-60),e.font="32px sans-serif",e.fillStyle="#fff",e.fillText(`Score: ${T}`,r.width/2,r.height/2-10),e.fillText(`Top Score: ${A}`,r.width/2,r.height/2+40),T>Number(localStorage.getItem("topScore")||"0")&&(e.font="bold 28px sans-serif",e.fillStyle="#0cf",e.fillText("You beat your own top score!",r.width/2,r.height/2+90),K===0&&H()),e.restore(),ne()):ue(),e.save(),e.translate(-x,0),e.fillStyle="#fff",e.fillRect(d.x,d.y,8,d.height),e.beginPath(),e.moveTo(d.x+8,d.y),e.lineTo(d.x+8+32,d.y+16),e.lineTo(d.x+8,d.y+32),e.closePath(),e.fillStyle="#e33",e.fill(),e.restore(),we()}function se(){const o=performance.now(),t=o-Z;ve(),t>=1e3/ce&&(ee++,ee%60===0&&(oe=Math.round(1e3/(t/60))),me(t/1e3),xe(),Z=o),requestAnimationFrame(se)}const f={};let le=!1,D=0;window.addEventListener("keydown",o=>{f[o.code]=!0});window.addEventListener("keyup",o=>{f[o.code]=!1});function Se(){if(!/Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop/i.test(navigator.userAgent))return;const t=document.getElementById("btn-left"),h=document.getElementById("btn-right"),i=document.getElementById("btn-jump");t&&h&&i&&(t.addEventListener("touchstart",n=>{n.preventDefault(),f.ArrowLeft=!0}),t.addEventListener("touchend",n=>{n.preventDefault(),f.ArrowLeft=!1}),h.addEventListener("touchstart",n=>{n.preventDefault(),f.ArrowRight=!0}),h.addEventListener("touchend",n=>{n.preventDefault(),f.ArrowRight=!1}),i.addEventListener("touchstart",n=>{n.preventDefault(),f.Space=!0}),i.addEventListener("touchend",n=>{n.preventDefault(),f.Space=!1}))}Se();se();
